<map version="1.0" orientation="orthogonal" width="17" height="16" tilewidth="32" tileheight="32">
  <properties>
    <property name="name" value="the Abblegard Castle"/>
  </properties>
  <tileset firstgid="1" name="graphics" tilewidth="32" tileheight="32">
    <image source="graphics.png" width="320" height="1184"/>
  </tileset>
  <layer name="Tile Layer 1" width="17" height="16">
    <data>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="57"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="57"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="57"/>
      <tile gid="31"/>
      <tile gid="32"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="1"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="32"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="57"/>
      <tile gid="39"/>
      <tile gid="21"/>
      <tile gid="33"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="39"/>
      <tile gid="21"/>
      <tile gid="33"/>
      <tile gid="31"/>
      <tile gid="57"/>
      <tile gid="39"/>
      <tile gid="21"/>
      <tile gid="33"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="39"/>
      <tile gid="21"/>
      <tile gid="33"/>
      <tile gid="31"/>
      <tile gid="57"/>
      <tile gid="39"/>
      <tile gid="21"/>
      <tile gid="33"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="39"/>
      <tile gid="21"/>
      <tile gid="33"/>
      <tile gid="31"/>
      <tile gid="57"/>
      <tile gid="31"/>
      <tile gid="38"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="38"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="31"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
      <tile gid="57"/>
    </data>
  </layer>
  <layer name="Tile Layer 2" width="17" height="16">
    <data>
      <tile gid="261"/>
      <tile gid="331"/>
      <tile gid="331"/>
      <tile gid="331"/>
      <tile gid="291"/>
      <tile gid="12"/>
      <tile gid="12"/>
      <tile gid="12"/>
      <tile gid="12"/>
      <tile gid="12"/>
      <tile gid="12"/>
      <tile gid="12"/>
      <tile gid="251"/>
      <tile gid="331"/>
      <tile gid="331"/>
      <tile gid="331"/>
      <tile gid="301"/>
      <tile gid="241"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="59"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="241"/>
      <tile gid="241"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="12"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="58"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="12"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="241"/>
      <tile gid="241"/>
      <tile gid="0"/>
      <tile gid="251"/>
      <tile gid="331"/>
      <tile gid="291"/>
      <tile gid="12"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="58"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="12"/>
      <tile gid="251"/>
      <tile gid="331"/>
      <tile gid="291"/>
      <tile gid="0"/>
      <tile gid="241"/>
      <tile gid="241"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="12"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="68"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="12"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="241"/>
      <tile gid="241"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="12"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="12"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="241"/>
      <tile gid="241"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="241"/>
      <tile gid="241"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="136"/>
      <tile gid="0"/>
      <tile gid="136"/>
      <tile gid="0"/>
      <tile gid="136"/>
      <tile gid="0"/>
      <tile gid="136"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="241"/>
      <tile gid="241"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="241"/>
      <tile gid="241"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="241"/>
      <tile gid="241"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="241"/>
      <tile gid="241"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="241"/>
      <tile gid="281"/>
      <tile gid="331"/>
      <tile gid="331"/>
      <tile gid="331"/>
      <tile gid="331"/>
      <tile gid="291"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="251"/>
      <tile gid="331"/>
      <tile gid="331"/>
      <tile gid="331"/>
      <tile gid="331"/>
      <tile gid="321"/>
      <tile gid="241"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="241"/>
      <tile gid="241"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="221"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="221"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="241"/>
      <tile gid="271"/>
      <tile gid="331"/>
      <tile gid="331"/>
      <tile gid="331"/>
      <tile gid="331"/>
      <tile gid="351"/>
      <tile gid="291"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="0"/>
      <tile gid="251"/>
      <tile gid="351"/>
      <tile gid="331"/>
      <tile gid="331"/>
      <tile gid="331"/>
      <tile gid="331"/>
      <tile gid="311"/>
    </data>
  </layer>
  <objectgroup name="objects" width="17" height="16">
    <object name="abblegardcastle" class="Bridge" x="224" y="480" width="96" height="32">
      <attribute name="ID" value="20"/>
      <attribute name="name" value="abblegardcastle"/>
      <attribute name="takeable" value="false"/>
      <attribute name="usable" value="false"/>
      <attribute name="burrowed" value="false"/>
    </object>
    <object name="abblegardcastle" class="BridgeDestination" x="224" y="448" width="96" height="32">
      <attribute name="ID" value="21"/>
      <attribute name="name" value="abblegardcastle"/>
      <attribute name="takeable" value="false"/>
      <attribute name="usable" value="false"/>
      <attribute name="burrowed" value="false"/>
    </object>
    <object class="Door" completeRedefinition="true" x="32" y="96" width="32" height="32">
      <animation name="closed" dx="1" dy="1" period="1" looping="false" file="graphics.png">39</animation>
      <attribute name="ID" value="22"/>
      <attribute name="name" value="door"/>
      <attribute name="takeable" value="false"/>
      <attribute name="usable" value="false"/>
      <attribute name="burrowed" value="false"/>
      <attribute name="doorID" value="L1"/>
      <attribute name="closed" value="true"/>
    </object>
    <object class="Door" completeRedefinition="true" x="480" y="96" width="32" height="32">
      <animation name="closed" dx="1" dy="1" period="1" looping="false" file="graphics.png">39</animation>
      <attribute name="ID" value="23"/>
      <attribute name="name" value="door"/>
      <attribute name="takeable" value="false"/>
      <attribute name="usable" value="false"/>
      <attribute name="burrowed" value="false"/>
      <attribute name="doorID" value="L2"/>
      <attribute name="closed" value="true"/>
    </object>
    <object class="Door" completeRedefinition="true" x="160" y="32" width="32" height="32">
      <animation name="closed" dx="1" dy="1" period="1" looping="false" file="graphics.png">49</animation>
      <attribute name="ID" value="24"/>
      <attribute name="name" value="door"/>
      <attribute name="takeable" value="false"/>
      <attribute name="usable" value="false"/>
      <attribute name="burrowed" value="false"/>
      <attribute name="doorID" value="L3"/>
      <attribute name="closed" value="true"/>
    </object>
    <object class="Door" completeRedefinition="true" x="352" y="32" width="32" height="32">
      <animation name="closed" dx="1" dy="1" period="1" looping="false" file="graphics.png">49</animation>
      <attribute name="ID" value="25"/>
      <attribute name="name" value="door"/>
      <attribute name="takeable" value="false"/>
      <attribute name="usable" value="false"/>
      <attribute name="burrowed" value="false"/>
      <attribute name="doorID" value="L4"/>
      <attribute name="closed" value="true"/>
    </object>
    <object class="Lever" completeRedefinition="true" x="128" y="64" width="32" height="32">
      <animation name="open" dx="1" dy="1" period="1" looping="false" file="graphics.png">65</animation>
      <animation name="closed" dx="1" dy="1" period="1" looping="false" file="graphics.png">55</animation>
      <attribute name="ID" value="26"/>
      <attribute name="name" value="lever"/>
      <attribute name="takeable" value="false"/>
      <attribute name="usable" value="true"/>
      <attribute name="burrowed" value="false"/>
      <attribute name="leverID" value="L3"/>
      <attribute name="leverState" value="true"/>
    </object>
    <object class="Lever" completeRedefinition="true" x="32" y="448" width="32" height="32">
      <animation name="open" dx="1" dy="1" period="1" looping="false" file="graphics.png">65</animation>
      <animation name="closed" dx="1" dy="1" period="1" looping="false" file="graphics.png">55</animation>
      <attribute name="ID" value="27"/>
      <attribute name="name" value="lever"/>
      <attribute name="takeable" value="false"/>
      <attribute name="usable" value="true"/>
      <attribute name="burrowed" value="false"/>
      <attribute name="leverID" value="L1"/>
      <attribute name="leverState" value="true"/>
    </object>
    <object class="Lever" completeRedefinition="true" x="480" y="448" width="32" height="32">
      <animation name="open" dx="1" dy="1" period="1" looping="false" file="graphics.png">65</animation>
      <animation name="closed" dx="1" dy="1" period="1" looping="false" file="graphics.png">55</animation>
      <attribute name="ID" value="29"/>
      <attribute name="name" value="lever"/>
      <attribute name="takeable" value="false"/>
      <attribute name="usable" value="true"/>
      <attribute name="burrowed" value="false"/>
      <attribute name="leverID" value="L2"/>
      <attribute name="leverState" value="true"/>
    </object>
    <object class="Lever" completeRedefinition="true" x="384" y="64" width="32" height="32">
      <animation name="open" dx="1" dy="1" period="1" looping="false" file="graphics.png">65</animation>
      <animation name="closed" dx="1" dy="1" period="1" looping="false" file="graphics.png">55</animation>
      <attribute name="ID" value="30"/>
      <attribute name="name" value="lever"/>
      <attribute name="takeable" value="false"/>
      <attribute name="usable" value="true"/>
      <attribute name="burrowed" value="false"/>
      <attribute name="leverID" value="L4"/>
      <attribute name="leverState" value="true"/>
    </object>
    <object class="Chest" completeRedefinition="true" x="480" y="32" width="32" height="32">
      <animation name="idle" dx="1" dy="1" period="1" looping="false" file="graphics.png">29</animation>
      <attribute name="ID" value="48"/>
      <attribute name="name" value="Small chest"/>
      <attribute name="takeable" value="true"/>
      <attribute name="usable" value="true"/>
      <attribute name="burrowed" value="false"/>
      <items>
        <object class="Scroll" completeRedefinition="true">
          <animation name="idle" dx="1" dy="1" period="1" looping="false" file="graphics.png">144</animation>
          <attribute name="ID" value="49"/>
          <attribute name="name" value="Old Scroll"/>
          <attribute name="gold" value="25"/>
          <attribute name="takeable" value="true"/>
          <attribute name="usable" value="true"/>
          <attribute name="burrowed" value="false"/>
          <attribute name="spell" value="6"/>
        </object>
      </items>
    </object>
    <object class="Chest" completeRedefinition="true" x="32" y="32" width="32" height="32">
      <animation name="idle" dx="1" dy="1" period="1" looping="false" file="graphics.png">29</animation>
      <attribute name="ID" value="50"/>
      <attribute name="name" value="Small chest"/>
      <attribute name="takeable" value="true"/>
      <attribute name="usable" value="true"/>
      <attribute name="burrowed" value="false"/>
      <items>
        <object class="XPPotion" completeRedefinition="true">
          <animation name="idle" dx="1" dy="1" period="1" looping="false" file="graphics.png">13</animation>
          <attribute name="ID" value="51"/>
          <attribute name="name" value="XP Potion+25"/>
          <attribute name="gold" value="110"/>
          <attribute name="takeable" value="true"/>
          <attribute name="usable" value="true"/>
          <attribute name="burrowed" value="false"/>
          <attribute name="xp" value="25"/>
        </object>
      </items>
    </object>
    <object class="Soldier" completeRedefinition="true" x="192" y="160" width="32" height="32">
      <animation name="idle-left" dx="1" dy="1" period="4" looping="false" file="graphics.png">142</animation>
      <animation name="idle-up" dx="1" dy="1" period="4" looping="false" file="graphics.png">142</animation>
      <animation name="idle-right" dx="1" dy="1" period="4" looping="false" file="graphics.png">140</animation>
      <animation name="idle-down" dx="1" dy="1" period="4" looping="false" file="graphics.png">140</animation>
      <animation name="moving-left" dx="1" dy="1" period="4" looping="true" file="graphics.png">142,143</animation>
      <animation name="moving-up" dx="1" dy="1" period="4" looping="true" file="graphics.png">142,143</animation>
      <animation name="moving-right" dx="1" dy="1" period="4" looping="true" file="graphics.png">140,141</animation>
      <animation name="moving-down" dx="1" dy="1" period="4" looping="true" file="graphics.png">140,141</animation>
      <attribute name="ID" value="31"/>
      <attribute name="name" value="a Soldier"/>
      <attribute name="gold" value="10"/>
      <attribute name="canWalk" value="true"/>
      <attribute name="canSwim" value="false"/>
      <attribute name="takeable" value="false"/>
      <attribute name="usable" value="false"/>
      <attribute name="burrowed" value="false"/>
      <eventRule event="action_attack" hit="true">
        <playSound sound="sfx/hit.wav"/>
      </eventRule>
      <eventRule event="action_attack" hit="false">
        <playSound sound="sfx/miss.wav"/>
      </eventRule>
      <storyStateRule scope="game" variable="Granner" value="alive" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="I&#39;ve heart that Granners&#39;s alive!"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <storyStateRule scope="game" variable="Granner" value="dead" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="They say corpses have been washing ashore, it had never happened before!" performative="inform"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <storyStateRule scope="game" variable="Blozard" value="dead" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="I heard the King is looking for a husband for his daughter." performative="inform"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <storyStateRule scope="game" variable="King" value="dead" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="the king" consume="true" from="in-conversation">
          <talk text="King Cabolo was very generous, I don&#39;t know what is going to happen now with him dead!" performative="inform"/>
        </updateConversationGraphTransition>
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="I heard the princess will take a husband, I hope it&#39;s me!" performative="inform"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <attribute name="hp" value="30" levelupadd="0"/>
      <attribute name="max_hp" value="30"/>
      <attribute name="mp" value="0" levelupadd="0"/>
      <attribute name="max_mp" value="0"/>
      <attribute name="xp" value="0"/>
      <attribute name="level" value="1"/>
      <attribute name="experienceToLevelUp" value="10" levelupmultiply="1.5"/>
      <attribute name="gives_experience" value="20"/>
      <attribute name="attack" value="10" levelupadd="0"/>
      <attribute name="defense" value="5" levelupadd="0"/>
      <attribute name="attack_modifier" value="1"/>
      <attribute name="defense_modifier" value="1"/>
      <attribute name="walk_speed" value="16"/>
      <attribute name="magicImmune" value="false"/>
      <attribute name="direction" value="0"/>
      <attribute name="previous_direction" value="0"/>
      <attribute name="state" value="0"/>
      <attribute name="previous_state" value="0"/>
      <attribute name="state_cycle" value="841"/>
      <attribute name="sightRadius" value="7"/>
      <attribute name="respawn" value="0"/>
      <attribute name="AI.period" value="1"/>
      <attribute name="AI.cycle" value="841"/>
      <onStart>
        <addWME wme="object(32,192,96,224,128,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(32,Soldier)" activation="99"/>
        <addWME wme="object(34,320,160,352,192,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(34,Soldier)" activation="99"/>
        <addWME wme="object(35,320,96,352,128,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(35,Soldier)" activation="99"/>
        <addWME wme="object(39,32,128,64,160,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(39,Soldier)" activation="99"/>
        <addWME wme="object(42,192,32,224,64,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(42,Soldier)" activation="99"/>
        <addWME wme="object(43,320,32,352,64,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(43,Soldier)" activation="99"/>
        <addWME wme="object(45,256,64,288,96,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(45,King)" activation="99"/>
        <addWME wme="bridge(&#39;the forest&#39;,0,448,32,480,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the forest&#39;,736,256,768,288,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the Abblegard Castle&#39;,384,256,448,288,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;a shop&#39;,224,320,256,352,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;an armory&#39;,576,96,608,128,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the inn&#39;,576,384,608,416,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,160,448,256,480,&#39;the inn&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,608,608,640,640,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,768,512,800,544,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Black Rock entrance&#39;,128,96,160,128,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the east sea&#39;,1248,0,1280,1216,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the north sea&#39;,1024,0,1472,32,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,224,480,320,512,&#39;the Abblegard Castle&#39;)" activation="3000"/>
        <addWME wme="friendly(AbblegardCitizen)" activation="3000"/>
        <addWME wme="unfriendly(CultMember)" activation="3000"/>
        <addWME wme="unfriendly(Animal)" activation="3000"/>
        <addWME wme="unfriendly(Undead)" activation="3000"/>
        <addWME wme="location(&#39;home&#39;,192,160,224,192,&#39;the Abblegard Castle&#39;)" activation="3000"/>
        <addBehavior priority="50">
          <BAttackUnfriendly/>
location('home',192,160,224,192,'the Abblegard Castle')</addBehavior>
        <addBehavior priority="0">
          <BGoto location="home" radius="0"/>
location('home',192,160,224,192,'the Abblegard Castle')</addBehavior>
        <addBehavior priority="25">
          <BFollowFromWME radius="96"/>
location('home',192,160,224,192,'the Abblegard Castle')</addBehavior>
      </onStart>
      <inferenceRule premise="attack(?1,?2),is_a(?2,?3),friendly(?3),is_a(?1,?4)" conclusion="unfriendly(?4)" frequency="0.25" activation="3000" cooldown="50"/>
      <conversationGraph>
        <state name="none">
          <transition actor="self" performative="hi" state="sent-hi" consume="true"/>
          <transition actor="other" performative="hi" state="in-conversation-only-hi" consume="true">
            <talk text="Good day!" performative="hi"/>
          </transition>
          <transition actor="other" performative="bye" state="none" consume="true">
            <talk text="Farewell!" performative="bye"/>
          </transition>
          <transition actor="other" performative="inform" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="ask" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="trade" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
        </state>
        <state name="sent-hi">
          <transition actor="other" performative="hi" state="in-conversation-only-hi" consume="true"/>
          <transition actor="other" performative="bye" state="none" consume="true"/>
          <transition actor="other" performative="inform" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="ask" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="trade" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="timeout" state="none" consume="true">
            <talk text="So unpolite... we were talking!" performative="inform" angry="true" wait="true"/>
          </transition>
        </state>
        <state name="in-conversation-only-hi">
          <transition actor="other" performative="hi" state="in-conversation-only-hi" consume="true">
            <talk text="Yes, good day to you too, we already went through that..." performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" state="in-conversation" consume="false"/>
          <transition actor="self" performative="inform" state="in-conversation" consume="false"/>
          <transition actor="self" performative="ask" state="in-conversation" consume="false"/>
          <transition actor="self" performative="bye" state="in-conversation" consume="false"/>
          <transition actor="self" performative="trade" state="in-conversation" consume="false"/>
          <transition actor="other" performative="timeout" state="none" consume="true"/>
        </state>
        <state name="in-conversation">
          <transition actor="self" performative="bye" state="sent-bye" consume="true"/>
          <transition actor="self" performative="inform" consume="true"/>
          <transition actor="other" performative="hi" state="in-conversation" consume="true">
            <talk text="Yes, good day to you too, we already went through that..." performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="bye" state="none" consume="true">
            <talk text="Farewell!" performative="bye"/>
          </transition>
          <transition actor="other" performative="inform" state="in-conversation" consume="true"/>
          <transition actor="other" performative="ask" state="in-conversation" consume="true">
            <talk text="I am sorry, I do not know anything about that." performative="inform"/>
          </transition>
          <transition actor="other" performative="trade" state="in-trade" consume="true">
            <startTrading/>
          </transition>
          <transition actor="other" performative="timeout" state="none" consume="true">
            <talk text="So unpolite... we were talking!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="ask" keyword="yourself" consume="true">
            <talk text="I&#39;m a soldier. I maintain the peace in Abblegard." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="abblegard" consume="true">
            <talk text="Abblegard is built around the King&#39;s castle." performative="inform"/>
            <talk text="You&#39;ll find many shops and interesting stuff here!" performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="the king" consume="true">
            <talk text="King Cabolo is very generous, we are very proud to serve him." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="blozard" consume="true">
            <talk text="Blozard was a black dragon that hated Abblegard for some reason. Not sure why..." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="Granner" consume="true">
            <talk text="Granner was a fanatic of the cult. He rebuilt the whole cult even after Blozard was slain." performative="inform"/>
            <addTopic topic="the cult" text="What can you tell me about the cult?"/>
            <addTopic topic="blozard" text="What can you tell me about Blozard?"/>
          </transition>
          <transition actor="other" performative="ask" keyword="the cult" consume="true">
            <talk text="The cult is a religious organization that venerates Blozard as their God. Their headquarters were in a tower called the black rock." performative="inform"/>
            <addTopic topic="blozard" text="What can you tell me about Blozard?"/>
            <addTopic topic="the black rock" text="What can you tell me about the black rock?"/>
          </transition>
          <transition actor="other" performative="ask" keyword="the black rock" consume="true">
            <talk text="You can find the black rock in the north-west of Abblegard." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="Granner&#39;s tomb" consume="true">
            <talk text="Now, that&#39;s a weird question... but it should be in the graveyard south of sthe village." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="Monks" consume="true">
            <talk text="We knew something was going on! The King must be informed at once!" performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="rumors" consume="true">
            <talk text="I&#39;ve heart that Granners&#39;s remains have been stolen from his grave!" performative="inform"/>
            <addTopic topic="Granner" text="what can you tell me about Granner?"/>
            <addTopic topic="Granner&#39;s tomb" text="Where is Granner&#39;s tomb?"/>
          </transition>
        </state>
        <state name="in-trade">
          <transition actor="other" performative="endtrade" state="in-conversation" consume="true"/>
        </state>
        <state name="sent-bye">
          <transition actor="other" state="in-conversation" consume="false">
            <talk text="I thought we were done talking..." performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="bye" state="none" consume="true"/>
        </state>
      </conversationGraph>
    </object>
    <object class="Soldier" completeRedefinition="true" x="192" y="96" width="32" height="32">
      <animation name="idle-left" dx="1" dy="1" period="4" looping="false" file="graphics.png">142</animation>
      <animation name="idle-up" dx="1" dy="1" period="4" looping="false" file="graphics.png">142</animation>
      <animation name="idle-right" dx="1" dy="1" period="4" looping="false" file="graphics.png">140</animation>
      <animation name="idle-down" dx="1" dy="1" period="4" looping="false" file="graphics.png">140</animation>
      <animation name="moving-left" dx="1" dy="1" period="4" looping="true" file="graphics.png">142,143</animation>
      <animation name="moving-up" dx="1" dy="1" period="4" looping="true" file="graphics.png">142,143</animation>
      <animation name="moving-right" dx="1" dy="1" period="4" looping="true" file="graphics.png">140,141</animation>
      <animation name="moving-down" dx="1" dy="1" period="4" looping="true" file="graphics.png">140,141</animation>
      <attribute name="ID" value="32"/>
      <attribute name="name" value="a Soldier"/>
      <attribute name="gold" value="10"/>
      <attribute name="canWalk" value="true"/>
      <attribute name="canSwim" value="false"/>
      <attribute name="takeable" value="false"/>
      <attribute name="usable" value="false"/>
      <attribute name="burrowed" value="false"/>
      <eventRule event="action_attack" hit="true">
        <playSound sound="sfx/hit.wav"/>
      </eventRule>
      <eventRule event="action_attack" hit="false">
        <playSound sound="sfx/miss.wav"/>
      </eventRule>
      <storyStateRule scope="game" variable="Granner" value="alive" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="I&#39;ve heart that Granners&#39;s alive!"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <storyStateRule scope="game" variable="Granner" value="dead" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="They say corpses have been washing ashore, it had never happened before!" performative="inform"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <storyStateRule scope="game" variable="Blozard" value="dead" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="I heard the King is looking for a husband for his daughter." performative="inform"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <storyStateRule scope="game" variable="King" value="dead" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="the king" consume="true" from="in-conversation">
          <talk text="King Cabolo was very generous, I don&#39;t know what is going to happen now with him dead!" performative="inform"/>
        </updateConversationGraphTransition>
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="I heard the princess will take a husband, I hope it&#39;s me!" performative="inform"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <attribute name="hp" value="30" levelupadd="0"/>
      <attribute name="max_hp" value="30"/>
      <attribute name="mp" value="0" levelupadd="0"/>
      <attribute name="max_mp" value="0"/>
      <attribute name="xp" value="0"/>
      <attribute name="level" value="1"/>
      <attribute name="experienceToLevelUp" value="10" levelupmultiply="1.5"/>
      <attribute name="gives_experience" value="20"/>
      <attribute name="attack" value="10" levelupadd="0"/>
      <attribute name="defense" value="5" levelupadd="0"/>
      <attribute name="attack_modifier" value="1"/>
      <attribute name="defense_modifier" value="1"/>
      <attribute name="walk_speed" value="16"/>
      <attribute name="magicImmune" value="false"/>
      <attribute name="direction" value="0"/>
      <attribute name="previous_direction" value="0"/>
      <attribute name="state" value="0"/>
      <attribute name="previous_state" value="0"/>
      <attribute name="state_cycle" value="841"/>
      <items>
        <object class="Food" completeRedefinition="true">
          <animation name="idle" dx="1" dy="1" period="1" looping="false" file="graphics.png">18</animation>
          <attribute name="ID" value="33"/>
          <attribute name="name" value="Chicken Leg"/>
          <attribute name="gold" value="5"/>
          <attribute name="takeable" value="true"/>
          <attribute name="usable" value="false"/>
          <attribute name="burrowed" value="false"/>
          <attribute name="equipable" value="false"/>
          <attribute name="useUponTake" value="false"/>
          <attribute name="attackBonus" value="0"/>
          <attribute name="defenseBonus" value="0"/>
          <attribute name="magicMultiplier" value="1"/>
        </object>
      </items>
      <attribute name="sightRadius" value="7"/>
      <attribute name="respawn" value="0"/>
      <attribute name="AI.period" value="1"/>
      <attribute name="AI.cycle" value="841"/>
      <onStart>
        <addWME wme="object(31,192,160,224,192,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(31,Soldier)" activation="99"/>
        <addWME wme="object(34,320,160,352,192,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(34,Soldier)" activation="99"/>
        <addWME wme="object(35,320,96,352,128,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(35,Soldier)" activation="99"/>
        <addWME wme="object(39,32,128,64,160,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(39,Soldier)" activation="99"/>
        <addWME wme="object(42,192,32,224,64,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(42,Soldier)" activation="99"/>
        <addWME wme="object(43,320,32,352,64,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(43,Soldier)" activation="99"/>
        <addWME wme="object(45,256,64,288,96,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(45,King)" activation="99"/>
        <addWME wme="object(33,?,?,?,?,?)" activation="1"/>
        <addWME wme="is_a(33,Food)" activation="1"/>
        <addWME wme="bridge(&#39;the forest&#39;,0,448,32,480,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the forest&#39;,736,256,768,288,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the Abblegard Castle&#39;,384,256,448,288,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;a shop&#39;,224,320,256,352,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;an armory&#39;,576,96,608,128,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the inn&#39;,576,384,608,416,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,160,448,256,480,&#39;the inn&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,608,608,640,640,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,768,512,800,544,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Black Rock entrance&#39;,128,96,160,128,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the east sea&#39;,1248,0,1280,1216,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the north sea&#39;,1024,0,1472,32,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,224,480,320,512,&#39;the Abblegard Castle&#39;)" activation="3000"/>
        <addWME wme="friendly(AbblegardCitizen)" activation="3000"/>
        <addWME wme="unfriendly(CultMember)" activation="3000"/>
        <addWME wme="unfriendly(Animal)" activation="3000"/>
        <addWME wme="unfriendly(Undead)" activation="3000"/>
        <addWME wme="location(&#39;home&#39;,192,96,224,128,&#39;the Abblegard Castle&#39;)" activation="3000"/>
        <addBehavior priority="50">
          <BAttackUnfriendly/>
location('home',192,96,224,128,'the Abblegard Castle')</addBehavior>
        <addBehavior priority="0">
          <BGoto location="home" radius="0"/>
location('home',192,96,224,128,'the Abblegard Castle')</addBehavior>
        <addBehavior priority="25">
          <BFollowFromWME radius="96"/>
location('home',192,96,224,128,'the Abblegard Castle')</addBehavior>
      </onStart>
      <inferenceRule premise="attack(?1,?2),is_a(?2,?3),friendly(?3),is_a(?1,?4)" conclusion="unfriendly(?4)" frequency="0.25" activation="3000" cooldown="50"/>
      <conversationGraph>
        <state name="none">
          <transition actor="self" performative="hi" state="sent-hi" consume="true"/>
          <transition actor="other" performative="hi" state="in-conversation-only-hi" consume="true">
            <talk text="Good day!" performative="hi"/>
          </transition>
          <transition actor="other" performative="bye" state="none" consume="true">
            <talk text="Farewell!" performative="bye"/>
          </transition>
          <transition actor="other" performative="inform" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="ask" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="trade" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
        </state>
        <state name="sent-hi">
          <transition actor="other" performative="hi" state="in-conversation-only-hi" consume="true"/>
          <transition actor="other" performative="bye" state="none" consume="true"/>
          <transition actor="other" performative="inform" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="ask" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="trade" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="timeout" state="none" consume="true">
            <talk text="So unpolite... we were talking!" performative="inform" angry="true" wait="true"/>
          </transition>
        </state>
        <state name="in-conversation-only-hi">
          <transition actor="other" performative="hi" state="in-conversation-only-hi" consume="true">
            <talk text="Yes, good day to you too, we already went through that..." performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" state="in-conversation" consume="false"/>
          <transition actor="self" performative="inform" state="in-conversation" consume="false"/>
          <transition actor="self" performative="ask" state="in-conversation" consume="false"/>
          <transition actor="self" performative="bye" state="in-conversation" consume="false"/>
          <transition actor="self" performative="trade" state="in-conversation" consume="false"/>
          <transition actor="other" performative="timeout" state="none" consume="true"/>
        </state>
        <state name="in-conversation">
          <transition actor="self" performative="bye" state="sent-bye" consume="true"/>
          <transition actor="self" performative="inform" consume="true"/>
          <transition actor="other" performative="hi" state="in-conversation" consume="true">
            <talk text="Yes, good day to you too, we already went through that..." performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="bye" state="none" consume="true">
            <talk text="Farewell!" performative="bye"/>
          </transition>
          <transition actor="other" performative="inform" state="in-conversation" consume="true"/>
          <transition actor="other" performative="ask" state="in-conversation" consume="true">
            <talk text="I am sorry, I do not know anything about that." performative="inform"/>
          </transition>
          <transition actor="other" performative="trade" state="in-trade" consume="true">
            <startTrading/>
          </transition>
          <transition actor="other" performative="timeout" state="none" consume="true">
            <talk text="So unpolite... we were talking!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="ask" keyword="yourself" consume="true">
            <talk text="I&#39;m a soldier. I maintain the peace in Abblegard." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="abblegard" consume="true">
            <talk text="Abblegard is built around the King&#39;s castle." performative="inform"/>
            <talk text="You&#39;ll find many shops and interesting stuff here!" performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="the king" consume="true">
            <talk text="King Cabolo is very generous, we are very proud to serve him." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="blozard" consume="true">
            <talk text="Blozard was a black dragon that hated Abblegard for some reason. Not sure why..." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="Granner" consume="true">
            <talk text="Granner was a fanatic of the cult. He rebuilt the whole cult even after Blozard was slain." performative="inform"/>
            <addTopic topic="the cult" text="What can you tell me about the cult?"/>
            <addTopic topic="blozard" text="What can you tell me about Blozard?"/>
          </transition>
          <transition actor="other" performative="ask" keyword="the cult" consume="true">
            <talk text="The cult is a religious organization that venerates Blozard as their God. Their headquarters were in a tower called the black rock." performative="inform"/>
            <addTopic topic="blozard" text="What can you tell me about Blozard?"/>
            <addTopic topic="the black rock" text="What can you tell me about the black rock?"/>
          </transition>
          <transition actor="other" performative="ask" keyword="the black rock" consume="true">
            <talk text="You can find the black rock in the north-west of Abblegard." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="Granner&#39;s tomb" consume="true">
            <talk text="Now, that&#39;s a weird question... but it should be in the graveyard south of sthe village." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="Monks" consume="true">
            <talk text="We knew something was going on! The King must be informed at once!" performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="rumors" consume="true">
            <talk text="I&#39;ve heart that Granners&#39;s remains have been stolen from his grave!" performative="inform"/>
            <addTopic topic="Granner" text="what can you tell me about Granner?"/>
            <addTopic topic="Granner&#39;s tomb" text="Where is Granner&#39;s tomb?"/>
          </transition>
        </state>
        <state name="in-trade">
          <transition actor="other" performative="endtrade" state="in-conversation" consume="true"/>
        </state>
        <state name="sent-bye">
          <transition actor="other" state="in-conversation" consume="false">
            <talk text="I thought we were done talking..." performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="bye" state="none" consume="true"/>
        </state>
      </conversationGraph>
    </object>
    <object class="Soldier" completeRedefinition="true" x="320" y="160" width="32" height="32">
      <animation name="idle-left" dx="1" dy="1" period="4" looping="false" file="graphics.png">142</animation>
      <animation name="idle-up" dx="1" dy="1" period="4" looping="false" file="graphics.png">142</animation>
      <animation name="idle-right" dx="1" dy="1" period="4" looping="false" file="graphics.png">140</animation>
      <animation name="idle-down" dx="1" dy="1" period="4" looping="false" file="graphics.png">140</animation>
      <animation name="moving-left" dx="1" dy="1" period="4" looping="true" file="graphics.png">142,143</animation>
      <animation name="moving-up" dx="1" dy="1" period="4" looping="true" file="graphics.png">142,143</animation>
      <animation name="moving-right" dx="1" dy="1" period="4" looping="true" file="graphics.png">140,141</animation>
      <animation name="moving-down" dx="1" dy="1" period="4" looping="true" file="graphics.png">140,141</animation>
      <attribute name="ID" value="34"/>
      <attribute name="name" value="a Soldier"/>
      <attribute name="gold" value="10"/>
      <attribute name="canWalk" value="true"/>
      <attribute name="canSwim" value="false"/>
      <attribute name="takeable" value="false"/>
      <attribute name="usable" value="false"/>
      <attribute name="burrowed" value="false"/>
      <eventRule event="action_attack" hit="true">
        <playSound sound="sfx/hit.wav"/>
      </eventRule>
      <eventRule event="action_attack" hit="false">
        <playSound sound="sfx/miss.wav"/>
      </eventRule>
      <storyStateRule scope="game" variable="Granner" value="alive" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="I&#39;ve heart that Granners&#39;s alive!"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <storyStateRule scope="game" variable="Granner" value="dead" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="They say corpses have been washing ashore, it had never happened before!" performative="inform"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <storyStateRule scope="game" variable="Blozard" value="dead" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="I heard the King is looking for a husband for his daughter." performative="inform"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <storyStateRule scope="game" variable="King" value="dead" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="the king" consume="true" from="in-conversation">
          <talk text="King Cabolo was very generous, I don&#39;t know what is going to happen now with him dead!" performative="inform"/>
        </updateConversationGraphTransition>
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="I heard the princess will take a husband, I hope it&#39;s me!" performative="inform"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <attribute name="hp" value="30" levelupadd="0"/>
      <attribute name="max_hp" value="30"/>
      <attribute name="mp" value="0" levelupadd="0"/>
      <attribute name="max_mp" value="0"/>
      <attribute name="xp" value="0"/>
      <attribute name="level" value="1"/>
      <attribute name="experienceToLevelUp" value="10" levelupmultiply="1.5"/>
      <attribute name="gives_experience" value="20"/>
      <attribute name="attack" value="10" levelupadd="0"/>
      <attribute name="defense" value="5" levelupadd="0"/>
      <attribute name="attack_modifier" value="1"/>
      <attribute name="defense_modifier" value="1"/>
      <attribute name="walk_speed" value="16"/>
      <attribute name="magicImmune" value="false"/>
      <attribute name="direction" value="0"/>
      <attribute name="previous_direction" value="0"/>
      <attribute name="state" value="0"/>
      <attribute name="previous_state" value="0"/>
      <attribute name="state_cycle" value="841"/>
      <attribute name="sightRadius" value="7"/>
      <attribute name="respawn" value="0"/>
      <attribute name="AI.period" value="1"/>
      <attribute name="AI.cycle" value="841"/>
      <onStart>
        <addWME wme="object(31,192,160,224,192,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(31,Soldier)" activation="99"/>
        <addWME wme="object(32,192,96,224,128,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(32,Soldier)" activation="99"/>
        <addWME wme="object(35,320,96,352,128,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(35,Soldier)" activation="99"/>
        <addWME wme="object(40,480,128,512,160,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(40,Soldier)" activation="99"/>
        <addWME wme="object(42,192,32,224,64,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(42,Soldier)" activation="99"/>
        <addWME wme="object(43,320,32,352,64,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(43,Soldier)" activation="99"/>
        <addWME wme="object(45,256,64,288,96,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(45,King)" activation="99"/>
        <addWME wme="bridge(&#39;the forest&#39;,0,448,32,480,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the forest&#39;,736,256,768,288,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the Abblegard Castle&#39;,384,256,448,288,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;a shop&#39;,224,320,256,352,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;an armory&#39;,576,96,608,128,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the inn&#39;,576,384,608,416,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,160,448,256,480,&#39;the inn&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,608,608,640,640,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,768,512,800,544,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Black Rock entrance&#39;,128,96,160,128,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the east sea&#39;,1248,0,1280,1216,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the north sea&#39;,1024,0,1472,32,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,224,480,320,512,&#39;the Abblegard Castle&#39;)" activation="3000"/>
        <addWME wme="friendly(AbblegardCitizen)" activation="3000"/>
        <addWME wme="unfriendly(CultMember)" activation="3000"/>
        <addWME wme="unfriendly(Animal)" activation="3000"/>
        <addWME wme="unfriendly(Undead)" activation="3000"/>
        <addWME wme="location(&#39;home&#39;,320,160,352,192,&#39;the Abblegard Castle&#39;)" activation="3000"/>
        <addBehavior priority="50">
          <BAttackUnfriendly/>
location('home',320,160,352,192,'the Abblegard Castle')</addBehavior>
        <addBehavior priority="0">
          <BGoto location="home" radius="0"/>
location('home',320,160,352,192,'the Abblegard Castle')</addBehavior>
        <addBehavior priority="25">
          <BFollowFromWME radius="96"/>
location('home',320,160,352,192,'the Abblegard Castle')</addBehavior>
      </onStart>
      <inferenceRule premise="attack(?1,?2),is_a(?2,?3),friendly(?3),is_a(?1,?4)" conclusion="unfriendly(?4)" frequency="0.25" activation="3000" cooldown="50"/>
      <conversationGraph>
        <state name="none">
          <transition actor="self" performative="hi" state="sent-hi" consume="true"/>
          <transition actor="other" performative="hi" state="in-conversation-only-hi" consume="true">
            <talk text="Good day!" performative="hi"/>
          </transition>
          <transition actor="other" performative="bye" state="none" consume="true">
            <talk text="Farewell!" performative="bye"/>
          </transition>
          <transition actor="other" performative="inform" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="ask" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="trade" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
        </state>
        <state name="sent-hi">
          <transition actor="other" performative="hi" state="in-conversation-only-hi" consume="true"/>
          <transition actor="other" performative="bye" state="none" consume="true"/>
          <transition actor="other" performative="inform" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="ask" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="trade" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="timeout" state="none" consume="true">
            <talk text="So unpolite... we were talking!" performative="inform" angry="true" wait="true"/>
          </transition>
        </state>
        <state name="in-conversation-only-hi">
          <transition actor="other" performative="hi" state="in-conversation-only-hi" consume="true">
            <talk text="Yes, good day to you too, we already went through that..." performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" state="in-conversation" consume="false"/>
          <transition actor="self" performative="inform" state="in-conversation" consume="false"/>
          <transition actor="self" performative="ask" state="in-conversation" consume="false"/>
          <transition actor="self" performative="bye" state="in-conversation" consume="false"/>
          <transition actor="self" performative="trade" state="in-conversation" consume="false"/>
          <transition actor="other" performative="timeout" state="none" consume="true"/>
        </state>
        <state name="in-conversation">
          <transition actor="self" performative="bye" state="sent-bye" consume="true"/>
          <transition actor="self" performative="inform" consume="true"/>
          <transition actor="other" performative="hi" state="in-conversation" consume="true">
            <talk text="Yes, good day to you too, we already went through that..." performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="bye" state="none" consume="true">
            <talk text="Farewell!" performative="bye"/>
          </transition>
          <transition actor="other" performative="inform" state="in-conversation" consume="true"/>
          <transition actor="other" performative="ask" state="in-conversation" consume="true">
            <talk text="I am sorry, I do not know anything about that." performative="inform"/>
          </transition>
          <transition actor="other" performative="trade" state="in-trade" consume="true">
            <startTrading/>
          </transition>
          <transition actor="other" performative="timeout" state="none" consume="true">
            <talk text="So unpolite... we were talking!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="ask" keyword="yourself" consume="true">
            <talk text="I&#39;m a soldier. I maintain the peace in Abblegard." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="abblegard" consume="true">
            <talk text="Abblegard is built around the King&#39;s castle." performative="inform"/>
            <talk text="You&#39;ll find many shops and interesting stuff here!" performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="the king" consume="true">
            <talk text="King Cabolo is very generous, we are very proud to serve him." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="blozard" consume="true">
            <talk text="Blozard was a black dragon that hated Abblegard for some reason. Not sure why..." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="Granner" consume="true">
            <talk text="Granner was a fanatic of the cult. He rebuilt the whole cult even after Blozard was slain." performative="inform"/>
            <addTopic topic="the cult" text="What can you tell me about the cult?"/>
            <addTopic topic="blozard" text="What can you tell me about Blozard?"/>
          </transition>
          <transition actor="other" performative="ask" keyword="the cult" consume="true">
            <talk text="The cult is a religious organization that venerates Blozard as their God. Their headquarters were in a tower called the black rock." performative="inform"/>
            <addTopic topic="blozard" text="What can you tell me about Blozard?"/>
            <addTopic topic="the black rock" text="What can you tell me about the black rock?"/>
          </transition>
          <transition actor="other" performative="ask" keyword="the black rock" consume="true">
            <talk text="You can find the black rock in the north-west of Abblegard." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="Granner&#39;s tomb" consume="true">
            <talk text="Now, that&#39;s a weird question... but it should be in the graveyard south of sthe village." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="Monks" consume="true">
            <talk text="We knew something was going on! The King must be informed at once!" performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="rumors" consume="true">
            <talk text="I&#39;ve heart that Granners&#39;s remains have been stolen from his grave!" performative="inform"/>
            <addTopic topic="Granner" text="what can you tell me about Granner?"/>
            <addTopic topic="Granner&#39;s tomb" text="Where is Granner&#39;s tomb?"/>
          </transition>
        </state>
        <state name="in-trade">
          <transition actor="other" performative="endtrade" state="in-conversation" consume="true"/>
        </state>
        <state name="sent-bye">
          <transition actor="other" state="in-conversation" consume="false">
            <talk text="I thought we were done talking..." performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="bye" state="none" consume="true"/>
        </state>
      </conversationGraph>
    </object>
    <object class="Soldier" completeRedefinition="true" x="320" y="96" width="32" height="32">
      <animation name="idle-left" dx="1" dy="1" period="4" looping="false" file="graphics.png">142</animation>
      <animation name="idle-up" dx="1" dy="1" period="4" looping="false" file="graphics.png">142</animation>
      <animation name="idle-right" dx="1" dy="1" period="4" looping="false" file="graphics.png">140</animation>
      <animation name="idle-down" dx="1" dy="1" period="4" looping="false" file="graphics.png">140</animation>
      <animation name="moving-left" dx="1" dy="1" period="4" looping="true" file="graphics.png">142,143</animation>
      <animation name="moving-up" dx="1" dy="1" period="4" looping="true" file="graphics.png">142,143</animation>
      <animation name="moving-right" dx="1" dy="1" period="4" looping="true" file="graphics.png">140,141</animation>
      <animation name="moving-down" dx="1" dy="1" period="4" looping="true" file="graphics.png">140,141</animation>
      <attribute name="ID" value="35"/>
      <attribute name="name" value="a Soldier"/>
      <attribute name="gold" value="10"/>
      <attribute name="canWalk" value="true"/>
      <attribute name="canSwim" value="false"/>
      <attribute name="takeable" value="false"/>
      <attribute name="usable" value="false"/>
      <attribute name="burrowed" value="false"/>
      <eventRule event="action_attack" hit="true">
        <playSound sound="sfx/hit.wav"/>
      </eventRule>
      <eventRule event="action_attack" hit="false">
        <playSound sound="sfx/miss.wav"/>
      </eventRule>
      <storyStateRule scope="game" variable="Granner" value="alive" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="I&#39;ve heart that Granners&#39;s alive!"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <storyStateRule scope="game" variable="Granner" value="dead" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="They say corpses have been washing ashore, it had never happened before!" performative="inform"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <storyStateRule scope="game" variable="Blozard" value="dead" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="I heard the King is looking for a husband for his daughter." performative="inform"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <storyStateRule scope="game" variable="King" value="dead" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="the king" consume="true" from="in-conversation">
          <talk text="King Cabolo was very generous, I don&#39;t know what is going to happen now with him dead!" performative="inform"/>
        </updateConversationGraphTransition>
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="I heard the princess will take a husband, I hope it&#39;s me!" performative="inform"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <attribute name="hp" value="30" levelupadd="0"/>
      <attribute name="max_hp" value="30"/>
      <attribute name="mp" value="0" levelupadd="0"/>
      <attribute name="max_mp" value="0"/>
      <attribute name="xp" value="0"/>
      <attribute name="level" value="1"/>
      <attribute name="experienceToLevelUp" value="10" levelupmultiply="1.5"/>
      <attribute name="gives_experience" value="20"/>
      <attribute name="attack" value="10" levelupadd="0"/>
      <attribute name="defense" value="5" levelupadd="0"/>
      <attribute name="attack_modifier" value="1"/>
      <attribute name="defense_modifier" value="1"/>
      <attribute name="walk_speed" value="16"/>
      <attribute name="magicImmune" value="false"/>
      <attribute name="direction" value="0"/>
      <attribute name="previous_direction" value="0"/>
      <attribute name="state" value="0"/>
      <attribute name="previous_state" value="0"/>
      <attribute name="state_cycle" value="841"/>
      <items>
        <object class="Food" completeRedefinition="true">
          <animation name="idle" dx="1" dy="1" period="1" looping="false" file="graphics.png">18</animation>
          <attribute name="ID" value="36"/>
          <attribute name="name" value="Chicken Leg"/>
          <attribute name="gold" value="5"/>
          <attribute name="takeable" value="true"/>
          <attribute name="usable" value="false"/>
          <attribute name="burrowed" value="false"/>
          <attribute name="equipable" value="false"/>
          <attribute name="useUponTake" value="false"/>
          <attribute name="attackBonus" value="0"/>
          <attribute name="defenseBonus" value="0"/>
          <attribute name="magicMultiplier" value="1"/>
        </object>
      </items>
      <attribute name="sightRadius" value="7"/>
      <attribute name="respawn" value="0"/>
      <attribute name="AI.period" value="1"/>
      <attribute name="AI.cycle" value="841"/>
      <onStart>
        <addWME wme="object(31,192,160,224,192,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(31,Soldier)" activation="99"/>
        <addWME wme="object(32,192,96,224,128,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(32,Soldier)" activation="99"/>
        <addWME wme="object(34,320,160,352,192,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(34,Soldier)" activation="99"/>
        <addWME wme="object(40,480,128,512,160,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(40,Soldier)" activation="99"/>
        <addWME wme="object(42,192,32,224,64,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(42,Soldier)" activation="99"/>
        <addWME wme="object(43,320,32,352,64,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(43,Soldier)" activation="99"/>
        <addWME wme="object(45,256,64,288,96,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(45,King)" activation="99"/>
        <addWME wme="object(36,?,?,?,?,?)" activation="1"/>
        <addWME wme="is_a(36,Food)" activation="1"/>
        <addWME wme="bridge(&#39;the forest&#39;,0,448,32,480,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the forest&#39;,736,256,768,288,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the Abblegard Castle&#39;,384,256,448,288,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;a shop&#39;,224,320,256,352,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;an armory&#39;,576,96,608,128,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the inn&#39;,576,384,608,416,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,160,448,256,480,&#39;the inn&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,608,608,640,640,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,768,512,800,544,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Black Rock entrance&#39;,128,96,160,128,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the east sea&#39;,1248,0,1280,1216,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the north sea&#39;,1024,0,1472,32,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,224,480,320,512,&#39;the Abblegard Castle&#39;)" activation="3000"/>
        <addWME wme="friendly(AbblegardCitizen)" activation="3000"/>
        <addWME wme="unfriendly(CultMember)" activation="3000"/>
        <addWME wme="unfriendly(Animal)" activation="3000"/>
        <addWME wme="unfriendly(Undead)" activation="3000"/>
        <addWME wme="location(&#39;home&#39;,320,96,352,128,&#39;the Abblegard Castle&#39;)" activation="3000"/>
        <addBehavior priority="50">
          <BAttackUnfriendly/>
location('home',320,96,352,128,'the Abblegard Castle')</addBehavior>
        <addBehavior priority="0">
          <BGoto location="home" radius="0"/>
location('home',320,96,352,128,'the Abblegard Castle')</addBehavior>
        <addBehavior priority="25">
          <BFollowFromWME radius="96"/>
location('home',320,96,352,128,'the Abblegard Castle')</addBehavior>
      </onStart>
      <inferenceRule premise="attack(?1,?2),is_a(?2,?3),friendly(?3),is_a(?1,?4)" conclusion="unfriendly(?4)" frequency="0.25" activation="3000" cooldown="50"/>
      <conversationGraph>
        <state name="none">
          <transition actor="self" performative="hi" state="sent-hi" consume="true"/>
          <transition actor="other" performative="hi" state="in-conversation-only-hi" consume="true">
            <talk text="Good day!" performative="hi"/>
          </transition>
          <transition actor="other" performative="bye" state="none" consume="true">
            <talk text="Farewell!" performative="bye"/>
          </transition>
          <transition actor="other" performative="inform" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="ask" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="trade" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
        </state>
        <state name="sent-hi">
          <transition actor="other" performative="hi" state="in-conversation-only-hi" consume="true"/>
          <transition actor="other" performative="bye" state="none" consume="true"/>
          <transition actor="other" performative="inform" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="ask" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="trade" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="timeout" state="none" consume="true">
            <talk text="So unpolite... we were talking!" performative="inform" angry="true" wait="true"/>
          </transition>
        </state>
        <state name="in-conversation-only-hi">
          <transition actor="other" performative="hi" state="in-conversation-only-hi" consume="true">
            <talk text="Yes, good day to you too, we already went through that..." performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" state="in-conversation" consume="false"/>
          <transition actor="self" performative="inform" state="in-conversation" consume="false"/>
          <transition actor="self" performative="ask" state="in-conversation" consume="false"/>
          <transition actor="self" performative="bye" state="in-conversation" consume="false"/>
          <transition actor="self" performative="trade" state="in-conversation" consume="false"/>
          <transition actor="other" performative="timeout" state="none" consume="true"/>
        </state>
        <state name="in-conversation">
          <transition actor="self" performative="bye" state="sent-bye" consume="true"/>
          <transition actor="self" performative="inform" consume="true"/>
          <transition actor="other" performative="hi" state="in-conversation" consume="true">
            <talk text="Yes, good day to you too, we already went through that..." performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="bye" state="none" consume="true">
            <talk text="Farewell!" performative="bye"/>
          </transition>
          <transition actor="other" performative="inform" state="in-conversation" consume="true"/>
          <transition actor="other" performative="ask" state="in-conversation" consume="true">
            <talk text="I am sorry, I do not know anything about that." performative="inform"/>
          </transition>
          <transition actor="other" performative="trade" state="in-trade" consume="true">
            <startTrading/>
          </transition>
          <transition actor="other" performative="timeout" state="none" consume="true">
            <talk text="So unpolite... we were talking!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="ask" keyword="yourself" consume="true">
            <talk text="I&#39;m a soldier. I maintain the peace in Abblegard." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="abblegard" consume="true">
            <talk text="Abblegard is built around the King&#39;s castle." performative="inform"/>
            <talk text="You&#39;ll find many shops and interesting stuff here!" performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="the king" consume="true">
            <talk text="King Cabolo is very generous, we are very proud to serve him." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="blozard" consume="true">
            <talk text="Blozard was a black dragon that hated Abblegard for some reason. Not sure why..." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="Granner" consume="true">
            <talk text="Granner was a fanatic of the cult. He rebuilt the whole cult even after Blozard was slain." performative="inform"/>
            <addTopic topic="the cult" text="What can you tell me about the cult?"/>
            <addTopic topic="blozard" text="What can you tell me about Blozard?"/>
          </transition>
          <transition actor="other" performative="ask" keyword="the cult" consume="true">
            <talk text="The cult is a religious organization that venerates Blozard as their God. Their headquarters were in a tower called the black rock." performative="inform"/>
            <addTopic topic="blozard" text="What can you tell me about Blozard?"/>
            <addTopic topic="the black rock" text="What can you tell me about the black rock?"/>
          </transition>
          <transition actor="other" performative="ask" keyword="the black rock" consume="true">
            <talk text="You can find the black rock in the north-west of Abblegard." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="Granner&#39;s tomb" consume="true">
            <talk text="Now, that&#39;s a weird question... but it should be in the graveyard south of sthe village." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="Monks" consume="true">
            <talk text="We knew something was going on! The King must be informed at once!" performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="rumors" consume="true">
            <talk text="I&#39;ve heart that Granners&#39;s remains have been stolen from his grave!" performative="inform"/>
            <addTopic topic="Granner" text="what can you tell me about Granner?"/>
            <addTopic topic="Granner&#39;s tomb" text="Where is Granner&#39;s tomb?"/>
          </transition>
        </state>
        <state name="in-trade">
          <transition actor="other" performative="endtrade" state="in-conversation" consume="true"/>
        </state>
        <state name="sent-bye">
          <transition actor="other" state="in-conversation" consume="false">
            <talk text="I thought we were done talking..." performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="bye" state="none" consume="true"/>
        </state>
      </conversationGraph>
    </object>
    <object class="Soldier" completeRedefinition="true" x="192" y="416" width="32" height="32">
      <animation name="idle-left" dx="1" dy="1" period="4" looping="false" file="graphics.png">142</animation>
      <animation name="idle-up" dx="1" dy="1" period="4" looping="false" file="graphics.png">142</animation>
      <animation name="idle-right" dx="1" dy="1" period="4" looping="false" file="graphics.png">140</animation>
      <animation name="idle-down" dx="1" dy="1" period="4" looping="false" file="graphics.png">140</animation>
      <animation name="moving-left" dx="1" dy="1" period="4" looping="true" file="graphics.png">142,143</animation>
      <animation name="moving-up" dx="1" dy="1" period="4" looping="true" file="graphics.png">142,143</animation>
      <animation name="moving-right" dx="1" dy="1" period="4" looping="true" file="graphics.png">140,141</animation>
      <animation name="moving-down" dx="1" dy="1" period="4" looping="true" file="graphics.png">140,141</animation>
      <attribute name="ID" value="37"/>
      <attribute name="name" value="a Soldier"/>
      <attribute name="gold" value="10"/>
      <attribute name="canWalk" value="true"/>
      <attribute name="canSwim" value="false"/>
      <attribute name="takeable" value="false"/>
      <attribute name="usable" value="false"/>
      <attribute name="burrowed" value="false"/>
      <eventRule event="action_attack" hit="true">
        <playSound sound="sfx/hit.wav"/>
      </eventRule>
      <eventRule event="action_attack" hit="false">
        <playSound sound="sfx/miss.wav"/>
      </eventRule>
      <storyStateRule scope="game" variable="Granner" value="alive" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="I&#39;ve heart that Granners&#39;s alive!"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <storyStateRule scope="game" variable="Granner" value="dead" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="They say corpses have been washing ashore, it had never happened before!" performative="inform"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <storyStateRule scope="game" variable="Blozard" value="dead" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="I heard the King is looking for a husband for his daughter." performative="inform"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <storyStateRule scope="game" variable="King" value="dead" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="the king" consume="true" from="in-conversation">
          <talk text="King Cabolo was very generous, I don&#39;t know what is going to happen now with him dead!" performative="inform"/>
        </updateConversationGraphTransition>
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="I heard the princess will take a husband, I hope it&#39;s me!" performative="inform"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <attribute name="hp" value="30" levelupadd="0"/>
      <attribute name="max_hp" value="30"/>
      <attribute name="mp" value="0" levelupadd="0"/>
      <attribute name="max_mp" value="0"/>
      <attribute name="xp" value="0"/>
      <attribute name="level" value="1"/>
      <attribute name="experienceToLevelUp" value="10" levelupmultiply="1.5"/>
      <attribute name="gives_experience" value="20"/>
      <attribute name="attack" value="10" levelupadd="0"/>
      <attribute name="defense" value="5" levelupadd="0"/>
      <attribute name="attack_modifier" value="1"/>
      <attribute name="defense_modifier" value="1"/>
      <attribute name="walk_speed" value="16"/>
      <attribute name="magicImmune" value="false"/>
      <attribute name="direction" value="0"/>
      <attribute name="previous_direction" value="0"/>
      <attribute name="state" value="0"/>
      <attribute name="previous_state" value="0"/>
      <attribute name="state_cycle" value="841"/>
      <attribute name="sightRadius" value="7"/>
      <attribute name="respawn" value="0"/>
      <attribute name="AI.period" value="1"/>
      <attribute name="AI.cycle" value="841"/>
      <onStart>
        <addWME wme="object(27,32,448,64,480,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(27,Lever)" activation="99"/>
        <addWME wme="object(38,320,416,352,448,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(38,Soldier)" activation="99"/>
        <addWME wme="bridge(&#39;the forest&#39;,0,448,32,480,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the forest&#39;,736,256,768,288,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the Abblegard Castle&#39;,384,256,448,288,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;a shop&#39;,224,320,256,352,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;an armory&#39;,576,96,608,128,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the inn&#39;,576,384,608,416,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,160,448,256,480,&#39;the inn&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,608,608,640,640,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,768,512,800,544,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Black Rock entrance&#39;,128,96,160,128,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the east sea&#39;,1248,0,1280,1216,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the north sea&#39;,1024,0,1472,32,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,224,480,320,512,&#39;the Abblegard Castle&#39;)" activation="3000"/>
        <addWME wme="friendly(AbblegardCitizen)" activation="3000"/>
        <addWME wme="unfriendly(CultMember)" activation="3000"/>
        <addWME wme="unfriendly(Animal)" activation="3000"/>
        <addWME wme="unfriendly(Undead)" activation="3000"/>
        <addWME wme="location(&#39;home&#39;,192,416,224,448,&#39;the Abblegard Castle&#39;)" activation="3000"/>
        <addBehavior priority="50">
          <BAttackUnfriendly/>
location('home',192,416,224,448,'the Abblegard Castle')</addBehavior>
        <addBehavior priority="0">
          <BGoto location="home" radius="0"/>
location('home',192,416,224,448,'the Abblegard Castle')</addBehavior>
        <addBehavior priority="25">
          <BFollowFromWME radius="96"/>
location('home',192,416,224,448,'the Abblegard Castle')</addBehavior>
      </onStart>
      <inferenceRule premise="attack(?1,?2),is_a(?2,?3),friendly(?3),is_a(?1,?4)" conclusion="unfriendly(?4)" frequency="0.25" activation="3000" cooldown="50"/>
      <conversationGraph>
        <state name="none">
          <transition actor="self" performative="hi" state="sent-hi" consume="true"/>
          <transition actor="other" performative="hi" state="in-conversation-only-hi" consume="true">
            <talk text="Good day!" performative="hi"/>
          </transition>
          <transition actor="other" performative="bye" state="none" consume="true">
            <talk text="Farewell!" performative="bye"/>
          </transition>
          <transition actor="other" performative="inform" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="ask" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="trade" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
        </state>
        <state name="sent-hi">
          <transition actor="other" performative="hi" state="in-conversation-only-hi" consume="true"/>
          <transition actor="other" performative="bye" state="none" consume="true"/>
          <transition actor="other" performative="inform" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="ask" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="trade" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="timeout" state="none" consume="true">
            <talk text="So unpolite... we were talking!" performative="inform" angry="true" wait="true"/>
          </transition>
        </state>
        <state name="in-conversation-only-hi">
          <transition actor="other" performative="hi" state="in-conversation-only-hi" consume="true">
            <talk text="Yes, good day to you too, we already went through that..." performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" state="in-conversation" consume="false"/>
          <transition actor="self" performative="inform" state="in-conversation" consume="false"/>
          <transition actor="self" performative="ask" state="in-conversation" consume="false"/>
          <transition actor="self" performative="bye" state="in-conversation" consume="false"/>
          <transition actor="self" performative="trade" state="in-conversation" consume="false"/>
          <transition actor="other" performative="timeout" state="none" consume="true"/>
        </state>
        <state name="in-conversation">
          <transition actor="self" performative="bye" state="sent-bye" consume="true"/>
          <transition actor="self" performative="inform" consume="true"/>
          <transition actor="other" performative="hi" state="in-conversation" consume="true">
            <talk text="Yes, good day to you too, we already went through that..." performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="bye" state="none" consume="true">
            <talk text="Farewell!" performative="bye"/>
          </transition>
          <transition actor="other" performative="inform" state="in-conversation" consume="true"/>
          <transition actor="other" performative="ask" state="in-conversation" consume="true">
            <talk text="I am sorry, I do not know anything about that." performative="inform"/>
          </transition>
          <transition actor="other" performative="trade" state="in-trade" consume="true">
            <startTrading/>
          </transition>
          <transition actor="other" performative="timeout" state="none" consume="true">
            <talk text="So unpolite... we were talking!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="ask" keyword="yourself" consume="true">
            <talk text="I&#39;m a soldier. I maintain the peace in Abblegard." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="abblegard" consume="true">
            <talk text="Abblegard is built around the King&#39;s castle." performative="inform"/>
            <talk text="You&#39;ll find many shops and interesting stuff here!" performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="the king" consume="true">
            <talk text="King Cabolo is very generous, we are very proud to serve him." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="blozard" consume="true">
            <talk text="Blozard was a black dragon that hated Abblegard for some reason. Not sure why..." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="Granner" consume="true">
            <talk text="Granner was a fanatic of the cult. He rebuilt the whole cult even after Blozard was slain." performative="inform"/>
            <addTopic topic="the cult" text="What can you tell me about the cult?"/>
            <addTopic topic="blozard" text="What can you tell me about Blozard?"/>
          </transition>
          <transition actor="other" performative="ask" keyword="the cult" consume="true">
            <talk text="The cult is a religious organization that venerates Blozard as their God. Their headquarters were in a tower called the black rock." performative="inform"/>
            <addTopic topic="blozard" text="What can you tell me about Blozard?"/>
            <addTopic topic="the black rock" text="What can you tell me about the black rock?"/>
          </transition>
          <transition actor="other" performative="ask" keyword="the black rock" consume="true">
            <talk text="You can find the black rock in the north-west of Abblegard." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="Granner&#39;s tomb" consume="true">
            <talk text="Now, that&#39;s a weird question... but it should be in the graveyard south of sthe village." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="Monks" consume="true">
            <talk text="We knew something was going on! The King must be informed at once!" performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="rumors" consume="true">
            <talk text="I&#39;ve heart that Granners&#39;s remains have been stolen from his grave!" performative="inform"/>
            <addTopic topic="Granner" text="what can you tell me about Granner?"/>
            <addTopic topic="Granner&#39;s tomb" text="Where is Granner&#39;s tomb?"/>
          </transition>
        </state>
        <state name="in-trade">
          <transition actor="other" performative="endtrade" state="in-conversation" consume="true"/>
        </state>
        <state name="sent-bye">
          <transition actor="other" state="in-conversation" consume="false">
            <talk text="I thought we were done talking..." performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="bye" state="none" consume="true"/>
        </state>
      </conversationGraph>
    </object>
    <object class="Soldier" completeRedefinition="true" x="320" y="416" width="32" height="32">
      <animation name="idle-left" dx="1" dy="1" period="4" looping="false" file="graphics.png">142</animation>
      <animation name="idle-up" dx="1" dy="1" period="4" looping="false" file="graphics.png">142</animation>
      <animation name="idle-right" dx="1" dy="1" period="4" looping="false" file="graphics.png">140</animation>
      <animation name="idle-down" dx="1" dy="1" period="4" looping="false" file="graphics.png">140</animation>
      <animation name="moving-left" dx="1" dy="1" period="4" looping="true" file="graphics.png">142,143</animation>
      <animation name="moving-up" dx="1" dy="1" period="4" looping="true" file="graphics.png">142,143</animation>
      <animation name="moving-right" dx="1" dy="1" period="4" looping="true" file="graphics.png">140,141</animation>
      <animation name="moving-down" dx="1" dy="1" period="4" looping="true" file="graphics.png">140,141</animation>
      <attribute name="ID" value="38"/>
      <attribute name="name" value="a Soldier"/>
      <attribute name="gold" value="10"/>
      <attribute name="canWalk" value="true"/>
      <attribute name="canSwim" value="false"/>
      <attribute name="takeable" value="false"/>
      <attribute name="usable" value="false"/>
      <attribute name="burrowed" value="false"/>
      <eventRule event="action_attack" hit="true">
        <playSound sound="sfx/hit.wav"/>
      </eventRule>
      <eventRule event="action_attack" hit="false">
        <playSound sound="sfx/miss.wav"/>
      </eventRule>
      <storyStateRule scope="game" variable="Granner" value="alive" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="I&#39;ve heart that Granners&#39;s alive!"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <storyStateRule scope="game" variable="Granner" value="dead" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="They say corpses have been washing ashore, it had never happened before!" performative="inform"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <storyStateRule scope="game" variable="Blozard" value="dead" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="I heard the King is looking for a husband for his daughter." performative="inform"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <storyStateRule scope="game" variable="King" value="dead" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="the king" consume="true" from="in-conversation">
          <talk text="King Cabolo was very generous, I don&#39;t know what is going to happen now with him dead!" performative="inform"/>
        </updateConversationGraphTransition>
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="I heard the princess will take a husband, I hope it&#39;s me!" performative="inform"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <attribute name="hp" value="30" levelupadd="0"/>
      <attribute name="max_hp" value="30"/>
      <attribute name="mp" value="0" levelupadd="0"/>
      <attribute name="max_mp" value="0"/>
      <attribute name="xp" value="0"/>
      <attribute name="level" value="1"/>
      <attribute name="experienceToLevelUp" value="10" levelupmultiply="1.5"/>
      <attribute name="gives_experience" value="20"/>
      <attribute name="attack" value="10" levelupadd="0"/>
      <attribute name="defense" value="5" levelupadd="0"/>
      <attribute name="attack_modifier" value="1"/>
      <attribute name="defense_modifier" value="1"/>
      <attribute name="walk_speed" value="16"/>
      <attribute name="magicImmune" value="false"/>
      <attribute name="direction" value="0"/>
      <attribute name="previous_direction" value="0"/>
      <attribute name="state" value="0"/>
      <attribute name="previous_state" value="0"/>
      <attribute name="state_cycle" value="841"/>
      <attribute name="sightRadius" value="7"/>
      <attribute name="respawn" value="0"/>
      <attribute name="AI.period" value="1"/>
      <attribute name="AI.cycle" value="841"/>
      <onStart>
        <addWME wme="object(29,480,448,512,480,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(29,Lever)" activation="99"/>
        <addWME wme="object(37,192,416,224,448,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(37,Soldier)" activation="99"/>
        <addWME wme="bridge(&#39;the forest&#39;,0,448,32,480,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the forest&#39;,736,256,768,288,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the Abblegard Castle&#39;,384,256,448,288,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;a shop&#39;,224,320,256,352,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;an armory&#39;,576,96,608,128,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the inn&#39;,576,384,608,416,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,160,448,256,480,&#39;the inn&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,608,608,640,640,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,768,512,800,544,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Black Rock entrance&#39;,128,96,160,128,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the east sea&#39;,1248,0,1280,1216,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the north sea&#39;,1024,0,1472,32,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,224,480,320,512,&#39;the Abblegard Castle&#39;)" activation="3000"/>
        <addWME wme="friendly(AbblegardCitizen)" activation="3000"/>
        <addWME wme="unfriendly(CultMember)" activation="3000"/>
        <addWME wme="unfriendly(Animal)" activation="3000"/>
        <addWME wme="unfriendly(Undead)" activation="3000"/>
        <addWME wme="location(&#39;home&#39;,320,416,352,448,&#39;the Abblegard Castle&#39;)" activation="3000"/>
        <addBehavior priority="50">
          <BAttackUnfriendly/>
location('home',320,416,352,448,'the Abblegard Castle')</addBehavior>
        <addBehavior priority="0">
          <BGoto location="home" radius="0"/>
location('home',320,416,352,448,'the Abblegard Castle')</addBehavior>
        <addBehavior priority="25">
          <BFollowFromWME radius="96"/>
location('home',320,416,352,448,'the Abblegard Castle')</addBehavior>
      </onStart>
      <inferenceRule premise="attack(?1,?2),is_a(?2,?3),friendly(?3),is_a(?1,?4)" conclusion="unfriendly(?4)" frequency="0.25" activation="3000" cooldown="50"/>
      <conversationGraph>
        <state name="none">
          <transition actor="self" performative="hi" state="sent-hi" consume="true"/>
          <transition actor="other" performative="hi" state="in-conversation-only-hi" consume="true">
            <talk text="Good day!" performative="hi"/>
          </transition>
          <transition actor="other" performative="bye" state="none" consume="true">
            <talk text="Farewell!" performative="bye"/>
          </transition>
          <transition actor="other" performative="inform" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="ask" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="trade" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
        </state>
        <state name="sent-hi">
          <transition actor="other" performative="hi" state="in-conversation-only-hi" consume="true"/>
          <transition actor="other" performative="bye" state="none" consume="true"/>
          <transition actor="other" performative="inform" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="ask" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="trade" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="timeout" state="none" consume="true">
            <talk text="So unpolite... we were talking!" performative="inform" angry="true" wait="true"/>
          </transition>
        </state>
        <state name="in-conversation-only-hi">
          <transition actor="other" performative="hi" state="in-conversation-only-hi" consume="true">
            <talk text="Yes, good day to you too, we already went through that..." performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" state="in-conversation" consume="false"/>
          <transition actor="self" performative="inform" state="in-conversation" consume="false"/>
          <transition actor="self" performative="ask" state="in-conversation" consume="false"/>
          <transition actor="self" performative="bye" state="in-conversation" consume="false"/>
          <transition actor="self" performative="trade" state="in-conversation" consume="false"/>
          <transition actor="other" performative="timeout" state="none" consume="true"/>
        </state>
        <state name="in-conversation">
          <transition actor="self" performative="bye" state="sent-bye" consume="true"/>
          <transition actor="self" performative="inform" consume="true"/>
          <transition actor="other" performative="hi" state="in-conversation" consume="true">
            <talk text="Yes, good day to you too, we already went through that..." performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="bye" state="none" consume="true">
            <talk text="Farewell!" performative="bye"/>
          </transition>
          <transition actor="other" performative="inform" state="in-conversation" consume="true"/>
          <transition actor="other" performative="ask" state="in-conversation" consume="true">
            <talk text="I am sorry, I do not know anything about that." performative="inform"/>
          </transition>
          <transition actor="other" performative="trade" state="in-trade" consume="true">
            <startTrading/>
          </transition>
          <transition actor="other" performative="timeout" state="none" consume="true">
            <talk text="So unpolite... we were talking!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="ask" keyword="yourself" consume="true">
            <talk text="I&#39;m a soldier. I maintain the peace in Abblegard." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="abblegard" consume="true">
            <talk text="Abblegard is built around the King&#39;s castle." performative="inform"/>
            <talk text="You&#39;ll find many shops and interesting stuff here!" performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="the king" consume="true">
            <talk text="King Cabolo is very generous, we are very proud to serve him." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="blozard" consume="true">
            <talk text="Blozard was a black dragon that hated Abblegard for some reason. Not sure why..." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="Granner" consume="true">
            <talk text="Granner was a fanatic of the cult. He rebuilt the whole cult even after Blozard was slain." performative="inform"/>
            <addTopic topic="the cult" text="What can you tell me about the cult?"/>
            <addTopic topic="blozard" text="What can you tell me about Blozard?"/>
          </transition>
          <transition actor="other" performative="ask" keyword="the cult" consume="true">
            <talk text="The cult is a religious organization that venerates Blozard as their God. Their headquarters were in a tower called the black rock." performative="inform"/>
            <addTopic topic="blozard" text="What can you tell me about Blozard?"/>
            <addTopic topic="the black rock" text="What can you tell me about the black rock?"/>
          </transition>
          <transition actor="other" performative="ask" keyword="the black rock" consume="true">
            <talk text="You can find the black rock in the north-west of Abblegard." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="Granner&#39;s tomb" consume="true">
            <talk text="Now, that&#39;s a weird question... but it should be in the graveyard south of sthe village." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="Monks" consume="true">
            <talk text="We knew something was going on! The King must be informed at once!" performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="rumors" consume="true">
            <talk text="I&#39;ve heart that Granners&#39;s remains have been stolen from his grave!" performative="inform"/>
            <addTopic topic="Granner" text="what can you tell me about Granner?"/>
            <addTopic topic="Granner&#39;s tomb" text="Where is Granner&#39;s tomb?"/>
          </transition>
        </state>
        <state name="in-trade">
          <transition actor="other" performative="endtrade" state="in-conversation" consume="true"/>
        </state>
        <state name="sent-bye">
          <transition actor="other" state="in-conversation" consume="false">
            <talk text="I thought we were done talking..." performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="bye" state="none" consume="true"/>
        </state>
      </conversationGraph>
    </object>
    <object class="Soldier" completeRedefinition="true" x="32" y="128" width="32" height="32">
      <animation name="idle-left" dx="1" dy="1" period="4" looping="false" file="graphics.png">142</animation>
      <animation name="idle-up" dx="1" dy="1" period="4" looping="false" file="graphics.png">142</animation>
      <animation name="idle-right" dx="1" dy="1" period="4" looping="false" file="graphics.png">140</animation>
      <animation name="idle-down" dx="1" dy="1" period="4" looping="false" file="graphics.png">140</animation>
      <animation name="moving-left" dx="1" dy="1" period="4" looping="true" file="graphics.png">142,143</animation>
      <animation name="moving-up" dx="1" dy="1" period="4" looping="true" file="graphics.png">142,143</animation>
      <animation name="moving-right" dx="1" dy="1" period="4" looping="true" file="graphics.png">140,141</animation>
      <animation name="moving-down" dx="1" dy="1" period="4" looping="true" file="graphics.png">140,141</animation>
      <attribute name="ID" value="39"/>
      <attribute name="name" value="a Soldier"/>
      <attribute name="gold" value="10"/>
      <attribute name="canWalk" value="true"/>
      <attribute name="canSwim" value="false"/>
      <attribute name="takeable" value="false"/>
      <attribute name="usable" value="false"/>
      <attribute name="burrowed" value="false"/>
      <eventRule event="action_attack" hit="true">
        <playSound sound="sfx/hit.wav"/>
      </eventRule>
      <eventRule event="action_attack" hit="false">
        <playSound sound="sfx/miss.wav"/>
      </eventRule>
      <storyStateRule scope="game" variable="Granner" value="alive" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="I&#39;ve heart that Granners&#39;s alive!"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <storyStateRule scope="game" variable="Granner" value="dead" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="They say corpses have been washing ashore, it had never happened before!" performative="inform"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <storyStateRule scope="game" variable="Blozard" value="dead" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="I heard the King is looking for a husband for his daughter." performative="inform"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <storyStateRule scope="game" variable="King" value="dead" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="the king" consume="true" from="in-conversation">
          <talk text="King Cabolo was very generous, I don&#39;t know what is going to happen now with him dead!" performative="inform"/>
        </updateConversationGraphTransition>
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="I heard the princess will take a husband, I hope it&#39;s me!" performative="inform"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <attribute name="hp" value="30" levelupadd="0"/>
      <attribute name="max_hp" value="30"/>
      <attribute name="mp" value="0" levelupadd="0"/>
      <attribute name="max_mp" value="0"/>
      <attribute name="xp" value="0"/>
      <attribute name="level" value="1"/>
      <attribute name="experienceToLevelUp" value="10" levelupmultiply="1.5"/>
      <attribute name="gives_experience" value="20"/>
      <attribute name="attack" value="10" levelupadd="0"/>
      <attribute name="defense" value="5" levelupadd="0"/>
      <attribute name="attack_modifier" value="1"/>
      <attribute name="defense_modifier" value="1"/>
      <attribute name="walk_speed" value="16"/>
      <attribute name="magicImmune" value="false"/>
      <attribute name="direction" value="0"/>
      <attribute name="previous_direction" value="0"/>
      <attribute name="state" value="0"/>
      <attribute name="previous_state" value="0"/>
      <attribute name="state_cycle" value="841"/>
      <attribute name="sightRadius" value="7"/>
      <attribute name="respawn" value="0"/>
      <attribute name="AI.period" value="1"/>
      <attribute name="AI.cycle" value="841"/>
      <onStart>
        <addWME wme="object(31,192,160,224,192,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(31,Soldier)" activation="99"/>
        <addWME wme="object(32,192,96,224,128,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(32,Soldier)" activation="99"/>
        <addWME wme="object(42,192,32,224,64,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(42,Soldier)" activation="99"/>
        <addWME wme="object(45,256,64,288,96,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(45,King)" activation="99"/>
        <addWME wme="bridge(&#39;the forest&#39;,0,448,32,480,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the forest&#39;,736,256,768,288,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the Abblegard Castle&#39;,384,256,448,288,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;a shop&#39;,224,320,256,352,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;an armory&#39;,576,96,608,128,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the inn&#39;,576,384,608,416,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,160,448,256,480,&#39;the inn&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,608,608,640,640,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,768,512,800,544,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Black Rock entrance&#39;,128,96,160,128,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the east sea&#39;,1248,0,1280,1216,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the north sea&#39;,1024,0,1472,32,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,224,480,320,512,&#39;the Abblegard Castle&#39;)" activation="3000"/>
        <addWME wme="friendly(AbblegardCitizen)" activation="3000"/>
        <addWME wme="unfriendly(CultMember)" activation="3000"/>
        <addWME wme="unfriendly(Animal)" activation="3000"/>
        <addWME wme="unfriendly(Undead)" activation="3000"/>
        <addWME wme="location(&#39;home&#39;,32,128,64,160,&#39;the Abblegard Castle&#39;)" activation="3000"/>
        <addBehavior priority="50">
          <BAttackUnfriendly/>
location('home',32,128,64,160,'the Abblegard Castle')</addBehavior>
        <addBehavior priority="0">
          <BGoto location="home" radius="0"/>
location('home',32,128,64,160,'the Abblegard Castle')</addBehavior>
        <addBehavior priority="25">
          <BFollowFromWME radius="96"/>
location('home',32,128,64,160,'the Abblegard Castle')</addBehavior>
      </onStart>
      <inferenceRule premise="attack(?1,?2),is_a(?2,?3),friendly(?3),is_a(?1,?4)" conclusion="unfriendly(?4)" frequency="0.25" activation="3000" cooldown="50"/>
      <conversationGraph>
        <state name="none">
          <transition actor="self" performative="hi" state="sent-hi" consume="true"/>
          <transition actor="other" performative="hi" state="in-conversation-only-hi" consume="true">
            <talk text="Good day!" performative="hi"/>
          </transition>
          <transition actor="other" performative="bye" state="none" consume="true">
            <talk text="Farewell!" performative="bye"/>
          </transition>
          <transition actor="other" performative="inform" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="ask" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="trade" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
        </state>
        <state name="sent-hi">
          <transition actor="other" performative="hi" state="in-conversation-only-hi" consume="true"/>
          <transition actor="other" performative="bye" state="none" consume="true"/>
          <transition actor="other" performative="inform" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="ask" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="trade" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="timeout" state="none" consume="true">
            <talk text="So unpolite... we were talking!" performative="inform" angry="true" wait="true"/>
          </transition>
        </state>
        <state name="in-conversation-only-hi">
          <transition actor="other" performative="hi" state="in-conversation-only-hi" consume="true">
            <talk text="Yes, good day to you too, we already went through that..." performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" state="in-conversation" consume="false"/>
          <transition actor="self" performative="inform" state="in-conversation" consume="false"/>
          <transition actor="self" performative="ask" state="in-conversation" consume="false"/>
          <transition actor="self" performative="bye" state="in-conversation" consume="false"/>
          <transition actor="self" performative="trade" state="in-conversation" consume="false"/>
          <transition actor="other" performative="timeout" state="none" consume="true"/>
        </state>
        <state name="in-conversation">
          <transition actor="self" performative="bye" state="sent-bye" consume="true"/>
          <transition actor="self" performative="inform" consume="true"/>
          <transition actor="other" performative="hi" state="in-conversation" consume="true">
            <talk text="Yes, good day to you too, we already went through that..." performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="bye" state="none" consume="true">
            <talk text="Farewell!" performative="bye"/>
          </transition>
          <transition actor="other" performative="inform" state="in-conversation" consume="true"/>
          <transition actor="other" performative="ask" state="in-conversation" consume="true">
            <talk text="I am sorry, I do not know anything about that." performative="inform"/>
          </transition>
          <transition actor="other" performative="trade" state="in-trade" consume="true">
            <startTrading/>
          </transition>
          <transition actor="other" performative="timeout" state="none" consume="true">
            <talk text="So unpolite... we were talking!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="ask" keyword="yourself" consume="true">
            <talk text="I&#39;m a soldier. I maintain the peace in Abblegard." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="abblegard" consume="true">
            <talk text="Abblegard is built around the King&#39;s castle." performative="inform"/>
            <talk text="You&#39;ll find many shops and interesting stuff here!" performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="the king" consume="true">
            <talk text="King Cabolo is very generous, we are very proud to serve him." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="blozard" consume="true">
            <talk text="Blozard was a black dragon that hated Abblegard for some reason. Not sure why..." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="Granner" consume="true">
            <talk text="Granner was a fanatic of the cult. He rebuilt the whole cult even after Blozard was slain." performative="inform"/>
            <addTopic topic="the cult" text="What can you tell me about the cult?"/>
            <addTopic topic="blozard" text="What can you tell me about Blozard?"/>
          </transition>
          <transition actor="other" performative="ask" keyword="the cult" consume="true">
            <talk text="The cult is a religious organization that venerates Blozard as their God. Their headquarters were in a tower called the black rock." performative="inform"/>
            <addTopic topic="blozard" text="What can you tell me about Blozard?"/>
            <addTopic topic="the black rock" text="What can you tell me about the black rock?"/>
          </transition>
          <transition actor="other" performative="ask" keyword="the black rock" consume="true">
            <talk text="You can find the black rock in the north-west of Abblegard." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="Granner&#39;s tomb" consume="true">
            <talk text="Now, that&#39;s a weird question... but it should be in the graveyard south of sthe village." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="Monks" consume="true">
            <talk text="We knew something was going on! The King must be informed at once!" performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="rumors" consume="true">
            <talk text="I&#39;ve heart that Granners&#39;s remains have been stolen from his grave!" performative="inform"/>
            <addTopic topic="Granner" text="what can you tell me about Granner?"/>
            <addTopic topic="Granner&#39;s tomb" text="Where is Granner&#39;s tomb?"/>
          </transition>
        </state>
        <state name="in-trade">
          <transition actor="other" performative="endtrade" state="in-conversation" consume="true"/>
        </state>
        <state name="sent-bye">
          <transition actor="other" state="in-conversation" consume="false">
            <talk text="I thought we were done talking..." performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="bye" state="none" consume="true"/>
        </state>
      </conversationGraph>
    </object>
    <object class="Soldier" completeRedefinition="true" x="480" y="128" width="32" height="32">
      <animation name="idle-left" dx="1" dy="1" period="4" looping="false" file="graphics.png">142</animation>
      <animation name="idle-up" dx="1" dy="1" period="4" looping="false" file="graphics.png">142</animation>
      <animation name="idle-right" dx="1" dy="1" period="4" looping="false" file="graphics.png">140</animation>
      <animation name="idle-down" dx="1" dy="1" period="4" looping="false" file="graphics.png">140</animation>
      <animation name="moving-left" dx="1" dy="1" period="4" looping="true" file="graphics.png">142,143</animation>
      <animation name="moving-up" dx="1" dy="1" period="4" looping="true" file="graphics.png">142,143</animation>
      <animation name="moving-right" dx="1" dy="1" period="4" looping="true" file="graphics.png">140,141</animation>
      <animation name="moving-down" dx="1" dy="1" period="4" looping="true" file="graphics.png">140,141</animation>
      <attribute name="ID" value="40"/>
      <attribute name="name" value="a Soldier"/>
      <attribute name="gold" value="10"/>
      <attribute name="canWalk" value="true"/>
      <attribute name="canSwim" value="false"/>
      <attribute name="takeable" value="false"/>
      <attribute name="usable" value="false"/>
      <attribute name="burrowed" value="false"/>
      <eventRule event="action_attack" hit="true">
        <playSound sound="sfx/hit.wav"/>
      </eventRule>
      <eventRule event="action_attack" hit="false">
        <playSound sound="sfx/miss.wav"/>
      </eventRule>
      <storyStateRule scope="game" variable="Granner" value="alive" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="I&#39;ve heart that Granners&#39;s alive!"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <storyStateRule scope="game" variable="Granner" value="dead" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="They say corpses have been washing ashore, it had never happened before!" performative="inform"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <storyStateRule scope="game" variable="Blozard" value="dead" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="I heard the King is looking for a husband for his daughter." performative="inform"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <storyStateRule scope="game" variable="King" value="dead" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="the king" consume="true" from="in-conversation">
          <talk text="King Cabolo was very generous, I don&#39;t know what is going to happen now with him dead!" performative="inform"/>
        </updateConversationGraphTransition>
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="I heard the princess will take a husband, I hope it&#39;s me!" performative="inform"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <attribute name="hp" value="30" levelupadd="0"/>
      <attribute name="max_hp" value="30"/>
      <attribute name="mp" value="0" levelupadd="0"/>
      <attribute name="max_mp" value="0"/>
      <attribute name="xp" value="0"/>
      <attribute name="level" value="1"/>
      <attribute name="experienceToLevelUp" value="10" levelupmultiply="1.5"/>
      <attribute name="gives_experience" value="20"/>
      <attribute name="attack" value="10" levelupadd="0"/>
      <attribute name="defense" value="5" levelupadd="0"/>
      <attribute name="attack_modifier" value="1"/>
      <attribute name="defense_modifier" value="1"/>
      <attribute name="walk_speed" value="16"/>
      <attribute name="magicImmune" value="false"/>
      <attribute name="direction" value="0"/>
      <attribute name="previous_direction" value="0"/>
      <attribute name="state" value="0"/>
      <attribute name="previous_state" value="0"/>
      <attribute name="state_cycle" value="841"/>
      <items>
        <object class="Food" completeRedefinition="true">
          <animation name="idle" dx="1" dy="1" period="1" looping="false" file="graphics.png">18</animation>
          <attribute name="ID" value="41"/>
          <attribute name="name" value="Chicken Leg"/>
          <attribute name="gold" value="5"/>
          <attribute name="takeable" value="true"/>
          <attribute name="usable" value="false"/>
          <attribute name="burrowed" value="false"/>
          <attribute name="equipable" value="false"/>
          <attribute name="useUponTake" value="false"/>
          <attribute name="attackBonus" value="0"/>
          <attribute name="defenseBonus" value="0"/>
          <attribute name="magicMultiplier" value="1"/>
        </object>
      </items>
      <attribute name="sightRadius" value="7"/>
      <attribute name="respawn" value="0"/>
      <attribute name="AI.period" value="1"/>
      <attribute name="AI.cycle" value="841"/>
      <onStart>
        <addWME wme="object(34,320,160,352,192,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(34,Soldier)" activation="99"/>
        <addWME wme="object(35,320,96,352,128,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(35,Soldier)" activation="99"/>
        <addWME wme="object(43,320,32,352,64,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(43,Soldier)" activation="99"/>
        <addWME wme="object(45,256,64,288,96,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(45,King)" activation="99"/>
        <addWME wme="object(41,?,?,?,?,?)" activation="1"/>
        <addWME wme="is_a(41,Food)" activation="1"/>
        <addWME wme="bridge(&#39;the forest&#39;,0,448,32,480,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the forest&#39;,736,256,768,288,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the Abblegard Castle&#39;,384,256,448,288,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;a shop&#39;,224,320,256,352,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;an armory&#39;,576,96,608,128,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the inn&#39;,576,384,608,416,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,160,448,256,480,&#39;the inn&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,608,608,640,640,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,768,512,800,544,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Black Rock entrance&#39;,128,96,160,128,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the east sea&#39;,1248,0,1280,1216,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the north sea&#39;,1024,0,1472,32,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,224,480,320,512,&#39;the Abblegard Castle&#39;)" activation="3000"/>
        <addWME wme="friendly(AbblegardCitizen)" activation="3000"/>
        <addWME wme="unfriendly(CultMember)" activation="3000"/>
        <addWME wme="unfriendly(Animal)" activation="3000"/>
        <addWME wme="unfriendly(Undead)" activation="3000"/>
        <addWME wme="location(&#39;home&#39;,480,128,512,160,&#39;the Abblegard Castle&#39;)" activation="3000"/>
        <addBehavior priority="50">
          <BAttackUnfriendly/>
location('home',480,128,512,160,'the Abblegard Castle')</addBehavior>
        <addBehavior priority="0">
          <BGoto location="home" radius="0"/>
location('home',480,128,512,160,'the Abblegard Castle')</addBehavior>
        <addBehavior priority="25">
          <BFollowFromWME radius="96"/>
location('home',480,128,512,160,'the Abblegard Castle')</addBehavior>
      </onStart>
      <inferenceRule premise="attack(?1,?2),is_a(?2,?3),friendly(?3),is_a(?1,?4)" conclusion="unfriendly(?4)" frequency="0.25" activation="3000" cooldown="50"/>
      <conversationGraph>
        <state name="none">
          <transition actor="self" performative="hi" state="sent-hi" consume="true"/>
          <transition actor="other" performative="hi" state="in-conversation-only-hi" consume="true">
            <talk text="Good day!" performative="hi"/>
          </transition>
          <transition actor="other" performative="bye" state="none" consume="true">
            <talk text="Farewell!" performative="bye"/>
          </transition>
          <transition actor="other" performative="inform" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="ask" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="trade" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
        </state>
        <state name="sent-hi">
          <transition actor="other" performative="hi" state="in-conversation-only-hi" consume="true"/>
          <transition actor="other" performative="bye" state="none" consume="true"/>
          <transition actor="other" performative="inform" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="ask" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="trade" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="timeout" state="none" consume="true">
            <talk text="So unpolite... we were talking!" performative="inform" angry="true" wait="true"/>
          </transition>
        </state>
        <state name="in-conversation-only-hi">
          <transition actor="other" performative="hi" state="in-conversation-only-hi" consume="true">
            <talk text="Yes, good day to you too, we already went through that..." performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" state="in-conversation" consume="false"/>
          <transition actor="self" performative="inform" state="in-conversation" consume="false"/>
          <transition actor="self" performative="ask" state="in-conversation" consume="false"/>
          <transition actor="self" performative="bye" state="in-conversation" consume="false"/>
          <transition actor="self" performative="trade" state="in-conversation" consume="false"/>
          <transition actor="other" performative="timeout" state="none" consume="true"/>
        </state>
        <state name="in-conversation">
          <transition actor="self" performative="bye" state="sent-bye" consume="true"/>
          <transition actor="self" performative="inform" consume="true"/>
          <transition actor="other" performative="hi" state="in-conversation" consume="true">
            <talk text="Yes, good day to you too, we already went through that..." performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="bye" state="none" consume="true">
            <talk text="Farewell!" performative="bye"/>
          </transition>
          <transition actor="other" performative="inform" state="in-conversation" consume="true"/>
          <transition actor="other" performative="ask" state="in-conversation" consume="true">
            <talk text="I am sorry, I do not know anything about that." performative="inform"/>
          </transition>
          <transition actor="other" performative="trade" state="in-trade" consume="true">
            <startTrading/>
          </transition>
          <transition actor="other" performative="timeout" state="none" consume="true">
            <talk text="So unpolite... we were talking!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="ask" keyword="yourself" consume="true">
            <talk text="I&#39;m a soldier. I maintain the peace in Abblegard." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="abblegard" consume="true">
            <talk text="Abblegard is built around the King&#39;s castle." performative="inform"/>
            <talk text="You&#39;ll find many shops and interesting stuff here!" performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="the king" consume="true">
            <talk text="King Cabolo is very generous, we are very proud to serve him." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="blozard" consume="true">
            <talk text="Blozard was a black dragon that hated Abblegard for some reason. Not sure why..." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="Granner" consume="true">
            <talk text="Granner was a fanatic of the cult. He rebuilt the whole cult even after Blozard was slain." performative="inform"/>
            <addTopic topic="the cult" text="What can you tell me about the cult?"/>
            <addTopic topic="blozard" text="What can you tell me about Blozard?"/>
          </transition>
          <transition actor="other" performative="ask" keyword="the cult" consume="true">
            <talk text="The cult is a religious organization that venerates Blozard as their God. Their headquarters were in a tower called the black rock." performative="inform"/>
            <addTopic topic="blozard" text="What can you tell me about Blozard?"/>
            <addTopic topic="the black rock" text="What can you tell me about the black rock?"/>
          </transition>
          <transition actor="other" performative="ask" keyword="the black rock" consume="true">
            <talk text="You can find the black rock in the north-west of Abblegard." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="Granner&#39;s tomb" consume="true">
            <talk text="Now, that&#39;s a weird question... but it should be in the graveyard south of sthe village." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="Monks" consume="true">
            <talk text="We knew something was going on! The King must be informed at once!" performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="rumors" consume="true">
            <talk text="I&#39;ve heart that Granners&#39;s remains have been stolen from his grave!" performative="inform"/>
            <addTopic topic="Granner" text="what can you tell me about Granner?"/>
            <addTopic topic="Granner&#39;s tomb" text="Where is Granner&#39;s tomb?"/>
          </transition>
        </state>
        <state name="in-trade">
          <transition actor="other" performative="endtrade" state="in-conversation" consume="true"/>
        </state>
        <state name="sent-bye">
          <transition actor="other" state="in-conversation" consume="false">
            <talk text="I thought we were done talking..." performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="bye" state="none" consume="true"/>
        </state>
      </conversationGraph>
    </object>
    <object class="Soldier" completeRedefinition="true" x="192" y="32" width="32" height="32">
      <animation name="idle-left" dx="1" dy="1" period="4" looping="false" file="graphics.png">142</animation>
      <animation name="idle-up" dx="1" dy="1" period="4" looping="false" file="graphics.png">142</animation>
      <animation name="idle-right" dx="1" dy="1" period="4" looping="false" file="graphics.png">140</animation>
      <animation name="idle-down" dx="1" dy="1" period="4" looping="false" file="graphics.png">140</animation>
      <animation name="moving-left" dx="1" dy="1" period="4" looping="true" file="graphics.png">142,143</animation>
      <animation name="moving-up" dx="1" dy="1" period="4" looping="true" file="graphics.png">142,143</animation>
      <animation name="moving-right" dx="1" dy="1" period="4" looping="true" file="graphics.png">140,141</animation>
      <animation name="moving-down" dx="1" dy="1" period="4" looping="true" file="graphics.png">140,141</animation>
      <attribute name="ID" value="42"/>
      <attribute name="name" value="a Soldier"/>
      <attribute name="gold" value="10"/>
      <attribute name="canWalk" value="true"/>
      <attribute name="canSwim" value="false"/>
      <attribute name="takeable" value="false"/>
      <attribute name="usable" value="false"/>
      <attribute name="burrowed" value="false"/>
      <eventRule event="action_attack" hit="true">
        <playSound sound="sfx/hit.wav"/>
      </eventRule>
      <eventRule event="action_attack" hit="false">
        <playSound sound="sfx/miss.wav"/>
      </eventRule>
      <storyStateRule scope="game" variable="Granner" value="alive" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="I&#39;ve heart that Granners&#39;s alive!"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <storyStateRule scope="game" variable="Granner" value="dead" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="They say corpses have been washing ashore, it had never happened before!" performative="inform"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <storyStateRule scope="game" variable="Blozard" value="dead" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="I heard the King is looking for a husband for his daughter." performative="inform"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <storyStateRule scope="game" variable="King" value="dead" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="the king" consume="true" from="in-conversation">
          <talk text="King Cabolo was very generous, I don&#39;t know what is going to happen now with him dead!" performative="inform"/>
        </updateConversationGraphTransition>
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="I heard the princess will take a husband, I hope it&#39;s me!" performative="inform"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <attribute name="hp" value="30" levelupadd="0"/>
      <attribute name="max_hp" value="30"/>
      <attribute name="mp" value="0" levelupadd="0"/>
      <attribute name="max_mp" value="0"/>
      <attribute name="xp" value="0"/>
      <attribute name="level" value="1"/>
      <attribute name="experienceToLevelUp" value="10" levelupmultiply="1.5"/>
      <attribute name="gives_experience" value="20"/>
      <attribute name="attack" value="10" levelupadd="0"/>
      <attribute name="defense" value="5" levelupadd="0"/>
      <attribute name="attack_modifier" value="1"/>
      <attribute name="defense_modifier" value="1"/>
      <attribute name="walk_speed" value="16"/>
      <attribute name="magicImmune" value="false"/>
      <attribute name="direction" value="0"/>
      <attribute name="previous_direction" value="0"/>
      <attribute name="state" value="0"/>
      <attribute name="previous_state" value="0"/>
      <attribute name="state_cycle" value="841"/>
      <attribute name="sightRadius" value="7"/>
      <attribute name="respawn" value="0"/>
      <attribute name="AI.period" value="1"/>
      <attribute name="AI.cycle" value="841"/>
      <onStart>
        <addWME wme="object(31,192,160,224,192,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(31,Soldier)" activation="99"/>
        <addWME wme="object(32,192,96,224,128,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(32,Soldier)" activation="99"/>
        <addWME wme="object(34,320,160,352,192,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(34,Soldier)" activation="99"/>
        <addWME wme="object(35,320,96,352,128,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(35,Soldier)" activation="99"/>
        <addWME wme="object(39,32,128,64,160,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(39,Soldier)" activation="99"/>
        <addWME wme="object(43,320,32,352,64,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(43,Soldier)" activation="99"/>
        <addWME wme="object(45,256,64,288,96,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(45,King)" activation="99"/>
        <addWME wme="bridge(&#39;the forest&#39;,0,448,32,480,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the forest&#39;,736,256,768,288,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the Abblegard Castle&#39;,384,256,448,288,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;a shop&#39;,224,320,256,352,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;an armory&#39;,576,96,608,128,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the inn&#39;,576,384,608,416,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,160,448,256,480,&#39;the inn&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,608,608,640,640,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,768,512,800,544,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Black Rock entrance&#39;,128,96,160,128,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the east sea&#39;,1248,0,1280,1216,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the north sea&#39;,1024,0,1472,32,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,224,480,320,512,&#39;the Abblegard Castle&#39;)" activation="3000"/>
        <addWME wme="friendly(AbblegardCitizen)" activation="3000"/>
        <addWME wme="unfriendly(CultMember)" activation="3000"/>
        <addWME wme="unfriendly(Animal)" activation="3000"/>
        <addWME wme="unfriendly(Undead)" activation="3000"/>
        <addWME wme="location(&#39;home&#39;,192,32,224,64,&#39;the Abblegard Castle&#39;)" activation="3000"/>
        <addBehavior priority="50">
          <BAttackUnfriendly/>
location('home',192,32,224,64,'the Abblegard Castle')</addBehavior>
        <addBehavior priority="0">
          <BGoto location="home" radius="0"/>
location('home',192,32,224,64,'the Abblegard Castle')</addBehavior>
        <addBehavior priority="25">
          <BFollowFromWME radius="96"/>
location('home',192,32,224,64,'the Abblegard Castle')</addBehavior>
      </onStart>
      <inferenceRule premise="attack(?1,?2),is_a(?2,?3),friendly(?3),is_a(?1,?4)" conclusion="unfriendly(?4)" frequency="0.25" activation="3000" cooldown="50"/>
      <conversationGraph>
        <state name="none">
          <transition actor="self" performative="hi" state="sent-hi" consume="true"/>
          <transition actor="other" performative="hi" state="in-conversation-only-hi" consume="true">
            <talk text="Good day!" performative="hi"/>
          </transition>
          <transition actor="other" performative="bye" state="none" consume="true">
            <talk text="Farewell!" performative="bye"/>
          </transition>
          <transition actor="other" performative="inform" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="ask" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="trade" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
        </state>
        <state name="sent-hi">
          <transition actor="other" performative="hi" state="in-conversation-only-hi" consume="true"/>
          <transition actor="other" performative="bye" state="none" consume="true"/>
          <transition actor="other" performative="inform" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="ask" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="trade" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="timeout" state="none" consume="true">
            <talk text="So unpolite... we were talking!" performative="inform" angry="true" wait="true"/>
          </transition>
        </state>
        <state name="in-conversation-only-hi">
          <transition actor="other" performative="hi" state="in-conversation-only-hi" consume="true">
            <talk text="Yes, good day to you too, we already went through that..." performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" state="in-conversation" consume="false"/>
          <transition actor="self" performative="inform" state="in-conversation" consume="false"/>
          <transition actor="self" performative="ask" state="in-conversation" consume="false"/>
          <transition actor="self" performative="bye" state="in-conversation" consume="false"/>
          <transition actor="self" performative="trade" state="in-conversation" consume="false"/>
          <transition actor="other" performative="timeout" state="none" consume="true"/>
        </state>
        <state name="in-conversation">
          <transition actor="self" performative="bye" state="sent-bye" consume="true"/>
          <transition actor="self" performative="inform" consume="true"/>
          <transition actor="other" performative="hi" state="in-conversation" consume="true">
            <talk text="Yes, good day to you too, we already went through that..." performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="bye" state="none" consume="true">
            <talk text="Farewell!" performative="bye"/>
          </transition>
          <transition actor="other" performative="inform" state="in-conversation" consume="true"/>
          <transition actor="other" performative="ask" state="in-conversation" consume="true">
            <talk text="I am sorry, I do not know anything about that." performative="inform"/>
          </transition>
          <transition actor="other" performative="trade" state="in-trade" consume="true">
            <startTrading/>
          </transition>
          <transition actor="other" performative="timeout" state="none" consume="true">
            <talk text="So unpolite... we were talking!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="ask" keyword="yourself" consume="true">
            <talk text="I&#39;m a soldier. I maintain the peace in Abblegard." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="abblegard" consume="true">
            <talk text="Abblegard is built around the King&#39;s castle." performative="inform"/>
            <talk text="You&#39;ll find many shops and interesting stuff here!" performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="the king" consume="true">
            <talk text="King Cabolo is very generous, we are very proud to serve him." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="blozard" consume="true">
            <talk text="Blozard was a black dragon that hated Abblegard for some reason. Not sure why..." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="Granner" consume="true">
            <talk text="Granner was a fanatic of the cult. He rebuilt the whole cult even after Blozard was slain." performative="inform"/>
            <addTopic topic="the cult" text="What can you tell me about the cult?"/>
            <addTopic topic="blozard" text="What can you tell me about Blozard?"/>
          </transition>
          <transition actor="other" performative="ask" keyword="the cult" consume="true">
            <talk text="The cult is a religious organization that venerates Blozard as their God. Their headquarters were in a tower called the black rock." performative="inform"/>
            <addTopic topic="blozard" text="What can you tell me about Blozard?"/>
            <addTopic topic="the black rock" text="What can you tell me about the black rock?"/>
          </transition>
          <transition actor="other" performative="ask" keyword="the black rock" consume="true">
            <talk text="You can find the black rock in the north-west of Abblegard." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="Granner&#39;s tomb" consume="true">
            <talk text="Now, that&#39;s a weird question... but it should be in the graveyard south of sthe village." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="Monks" consume="true">
            <talk text="We knew something was going on! The King must be informed at once!" performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="rumors" consume="true">
            <talk text="I&#39;ve heart that Granners&#39;s remains have been stolen from his grave!" performative="inform"/>
            <addTopic topic="Granner" text="what can you tell me about Granner?"/>
            <addTopic topic="Granner&#39;s tomb" text="Where is Granner&#39;s tomb?"/>
          </transition>
        </state>
        <state name="in-trade">
          <transition actor="other" performative="endtrade" state="in-conversation" consume="true"/>
        </state>
        <state name="sent-bye">
          <transition actor="other" state="in-conversation" consume="false">
            <talk text="I thought we were done talking..." performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="bye" state="none" consume="true"/>
        </state>
      </conversationGraph>
    </object>
    <object class="Soldier" completeRedefinition="true" x="320" y="32" width="32" height="32">
      <animation name="idle-left" dx="1" dy="1" period="4" looping="false" file="graphics.png">142</animation>
      <animation name="idle-up" dx="1" dy="1" period="4" looping="false" file="graphics.png">142</animation>
      <animation name="idle-right" dx="1" dy="1" period="4" looping="false" file="graphics.png">140</animation>
      <animation name="idle-down" dx="1" dy="1" period="4" looping="false" file="graphics.png">140</animation>
      <animation name="moving-left" dx="1" dy="1" period="4" looping="true" file="graphics.png">142,143</animation>
      <animation name="moving-up" dx="1" dy="1" period="4" looping="true" file="graphics.png">142,143</animation>
      <animation name="moving-right" dx="1" dy="1" period="4" looping="true" file="graphics.png">140,141</animation>
      <animation name="moving-down" dx="1" dy="1" period="4" looping="true" file="graphics.png">140,141</animation>
      <attribute name="ID" value="43"/>
      <attribute name="name" value="a Soldier"/>
      <attribute name="gold" value="10"/>
      <attribute name="canWalk" value="true"/>
      <attribute name="canSwim" value="false"/>
      <attribute name="takeable" value="false"/>
      <attribute name="usable" value="false"/>
      <attribute name="burrowed" value="false"/>
      <eventRule event="action_attack" hit="true">
        <playSound sound="sfx/hit.wav"/>
      </eventRule>
      <eventRule event="action_attack" hit="false">
        <playSound sound="sfx/miss.wav"/>
      </eventRule>
      <storyStateRule scope="game" variable="Granner" value="alive" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="I&#39;ve heart that Granners&#39;s alive!"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <storyStateRule scope="game" variable="Granner" value="dead" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="They say corpses have been washing ashore, it had never happened before!" performative="inform"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <storyStateRule scope="game" variable="Blozard" value="dead" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="I heard the King is looking for a husband for his daughter." performative="inform"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <storyStateRule scope="game" variable="King" value="dead" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="the king" consume="true" from="in-conversation">
          <talk text="King Cabolo was very generous, I don&#39;t know what is going to happen now with him dead!" performative="inform"/>
        </updateConversationGraphTransition>
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="I heard the princess will take a husband, I hope it&#39;s me!" performative="inform"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <attribute name="hp" value="30" levelupadd="0"/>
      <attribute name="max_hp" value="30"/>
      <attribute name="mp" value="0" levelupadd="0"/>
      <attribute name="max_mp" value="0"/>
      <attribute name="xp" value="0"/>
      <attribute name="level" value="1"/>
      <attribute name="experienceToLevelUp" value="10" levelupmultiply="1.5"/>
      <attribute name="gives_experience" value="20"/>
      <attribute name="attack" value="10" levelupadd="0"/>
      <attribute name="defense" value="5" levelupadd="0"/>
      <attribute name="attack_modifier" value="1"/>
      <attribute name="defense_modifier" value="1"/>
      <attribute name="walk_speed" value="16"/>
      <attribute name="magicImmune" value="false"/>
      <attribute name="direction" value="0"/>
      <attribute name="previous_direction" value="0"/>
      <attribute name="state" value="0"/>
      <attribute name="previous_state" value="0"/>
      <attribute name="state_cycle" value="841"/>
      <items>
        <object class="Food" completeRedefinition="true">
          <animation name="idle" dx="1" dy="1" period="1" looping="false" file="graphics.png">18</animation>
          <attribute name="ID" value="44"/>
          <attribute name="name" value="Chicken Leg"/>
          <attribute name="gold" value="5"/>
          <attribute name="takeable" value="true"/>
          <attribute name="usable" value="false"/>
          <attribute name="burrowed" value="false"/>
          <attribute name="equipable" value="false"/>
          <attribute name="useUponTake" value="false"/>
          <attribute name="attackBonus" value="0"/>
          <attribute name="defenseBonus" value="0"/>
          <attribute name="magicMultiplier" value="1"/>
        </object>
      </items>
      <attribute name="sightRadius" value="7"/>
      <attribute name="respawn" value="0"/>
      <attribute name="AI.period" value="1"/>
      <attribute name="AI.cycle" value="841"/>
      <onStart>
        <addWME wme="object(31,192,160,224,192,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(31,Soldier)" activation="99"/>
        <addWME wme="object(32,192,96,224,128,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(32,Soldier)" activation="99"/>
        <addWME wme="object(34,320,160,352,192,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(34,Soldier)" activation="99"/>
        <addWME wme="object(35,320,96,352,128,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(35,Soldier)" activation="99"/>
        <addWME wme="object(40,480,128,512,160,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(40,Soldier)" activation="99"/>
        <addWME wme="object(42,192,32,224,64,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(42,Soldier)" activation="99"/>
        <addWME wme="object(45,256,64,288,96,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(45,King)" activation="99"/>
        <addWME wme="object(44,?,?,?,?,?)" activation="1"/>
        <addWME wme="is_a(44,Food)" activation="1"/>
        <addWME wme="bridge(&#39;the forest&#39;,0,448,32,480,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the forest&#39;,736,256,768,288,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the Abblegard Castle&#39;,384,256,448,288,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;a shop&#39;,224,320,256,352,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;an armory&#39;,576,96,608,128,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the inn&#39;,576,384,608,416,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,160,448,256,480,&#39;the inn&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,608,608,640,640,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,768,512,800,544,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Black Rock entrance&#39;,128,96,160,128,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the east sea&#39;,1248,0,1280,1216,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the north sea&#39;,1024,0,1472,32,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,224,480,320,512,&#39;the Abblegard Castle&#39;)" activation="3000"/>
        <addWME wme="friendly(AbblegardCitizen)" activation="3000"/>
        <addWME wme="unfriendly(CultMember)" activation="3000"/>
        <addWME wme="unfriendly(Animal)" activation="3000"/>
        <addWME wme="unfriendly(Undead)" activation="3000"/>
        <addWME wme="location(&#39;home&#39;,320,32,352,64,&#39;the Abblegard Castle&#39;)" activation="3000"/>
        <addBehavior priority="50">
          <BAttackUnfriendly/>
location('home',320,32,352,64,'the Abblegard Castle')</addBehavior>
        <addBehavior priority="0">
          <BGoto location="home" radius="0"/>
location('home',320,32,352,64,'the Abblegard Castle')</addBehavior>
        <addBehavior priority="25">
          <BFollowFromWME radius="96"/>
location('home',320,32,352,64,'the Abblegard Castle')</addBehavior>
      </onStart>
      <inferenceRule premise="attack(?1,?2),is_a(?2,?3),friendly(?3),is_a(?1,?4)" conclusion="unfriendly(?4)" frequency="0.25" activation="3000" cooldown="50"/>
      <conversationGraph>
        <state name="none">
          <transition actor="self" performative="hi" state="sent-hi" consume="true"/>
          <transition actor="other" performative="hi" state="in-conversation-only-hi" consume="true">
            <talk text="Good day!" performative="hi"/>
          </transition>
          <transition actor="other" performative="bye" state="none" consume="true">
            <talk text="Farewell!" performative="bye"/>
          </transition>
          <transition actor="other" performative="inform" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="ask" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="trade" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
        </state>
        <state name="sent-hi">
          <transition actor="other" performative="hi" state="in-conversation-only-hi" consume="true"/>
          <transition actor="other" performative="bye" state="none" consume="true"/>
          <transition actor="other" performative="inform" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="ask" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="trade" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start a conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="timeout" state="none" consume="true">
            <talk text="So unpolite... we were talking!" performative="inform" angry="true" wait="true"/>
          </transition>
        </state>
        <state name="in-conversation-only-hi">
          <transition actor="other" performative="hi" state="in-conversation-only-hi" consume="true">
            <talk text="Yes, good day to you too, we already went through that..." performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" state="in-conversation" consume="false"/>
          <transition actor="self" performative="inform" state="in-conversation" consume="false"/>
          <transition actor="self" performative="ask" state="in-conversation" consume="false"/>
          <transition actor="self" performative="bye" state="in-conversation" consume="false"/>
          <transition actor="self" performative="trade" state="in-conversation" consume="false"/>
          <transition actor="other" performative="timeout" state="none" consume="true"/>
        </state>
        <state name="in-conversation">
          <transition actor="self" performative="bye" state="sent-bye" consume="true"/>
          <transition actor="self" performative="inform" consume="true"/>
          <transition actor="other" performative="hi" state="in-conversation" consume="true">
            <talk text="Yes, good day to you too, we already went through that..." performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="bye" state="none" consume="true">
            <talk text="Farewell!" performative="bye"/>
          </transition>
          <transition actor="other" performative="inform" state="in-conversation" consume="true"/>
          <transition actor="other" performative="ask" state="in-conversation" consume="true">
            <talk text="I am sorry, I do not know anything about that." performative="inform"/>
          </transition>
          <transition actor="other" performative="trade" state="in-trade" consume="true">
            <startTrading/>
          </transition>
          <transition actor="other" performative="timeout" state="none" consume="true">
            <talk text="So unpolite... we were talking!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="ask" keyword="yourself" consume="true">
            <talk text="I&#39;m a soldier. I maintain the peace in Abblegard." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="abblegard" consume="true">
            <talk text="Abblegard is built around the King&#39;s castle." performative="inform"/>
            <talk text="You&#39;ll find many shops and interesting stuff here!" performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="the king" consume="true">
            <talk text="King Cabolo is very generous, we are very proud to serve him." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="blozard" consume="true">
            <talk text="Blozard was a black dragon that hated Abblegard for some reason. Not sure why..." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="Granner" consume="true">
            <talk text="Granner was a fanatic of the cult. He rebuilt the whole cult even after Blozard was slain." performative="inform"/>
            <addTopic topic="the cult" text="What can you tell me about the cult?"/>
            <addTopic topic="blozard" text="What can you tell me about Blozard?"/>
          </transition>
          <transition actor="other" performative="ask" keyword="the cult" consume="true">
            <talk text="The cult is a religious organization that venerates Blozard as their God. Their headquarters were in a tower called the black rock." performative="inform"/>
            <addTopic topic="blozard" text="What can you tell me about Blozard?"/>
            <addTopic topic="the black rock" text="What can you tell me about the black rock?"/>
          </transition>
          <transition actor="other" performative="ask" keyword="the black rock" consume="true">
            <talk text="You can find the black rock in the north-west of Abblegard." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="Granner&#39;s tomb" consume="true">
            <talk text="Now, that&#39;s a weird question... but it should be in the graveyard south of sthe village." performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="Monks" consume="true">
            <talk text="We knew something was going on! The King must be informed at once!" performative="inform"/>
          </transition>
          <transition actor="other" performative="ask" keyword="rumors" consume="true">
            <talk text="I&#39;ve heart that Granners&#39;s remains have been stolen from his grave!" performative="inform"/>
            <addTopic topic="Granner" text="what can you tell me about Granner?"/>
            <addTopic topic="Granner&#39;s tomb" text="Where is Granner&#39;s tomb?"/>
          </transition>
        </state>
        <state name="in-trade">
          <transition actor="other" performative="endtrade" state="in-conversation" consume="true"/>
        </state>
        <state name="sent-bye">
          <transition actor="other" state="in-conversation" consume="false">
            <talk text="I thought we were done talking..." performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="bye" state="none" consume="true"/>
        </state>
      </conversationGraph>
    </object>
    <object class="King" completeRedefinition="true" x="256" y="64" width="32" height="32">
      <animation name="idle-left" dx="1" dy="1" period="4" looping="false" file="graphics.png">78</animation>
      <animation name="idle-up" dx="1" dy="1" period="4" looping="false" file="graphics.png">78</animation>
      <animation name="idle-right" dx="1" dy="1" period="4" looping="false" file="graphics.png">76</animation>
      <animation name="idle-down" dx="1" dy="1" period="4" looping="false" file="graphics.png">76</animation>
      <animation name="moving-left" dx="1" dy="1" period="4" looping="true" file="graphics.png">78,79</animation>
      <animation name="moving-up" dx="1" dy="1" period="4" looping="true" file="graphics.png">78,79</animation>
      <animation name="moving-right" dx="1" dy="1" period="4" looping="true" file="graphics.png">76,77</animation>
      <animation name="moving-down" dx="1" dy="1" period="4" looping="true" file="graphics.png">76,77</animation>
      <attribute name="ID" value="45"/>
      <attribute name="name" value="King Cabolo"/>
      <attribute name="gold" value="10000"/>
      <attribute name="canWalk" value="true"/>
      <attribute name="canSwim" value="false"/>
      <attribute name="takeable" value="false"/>
      <attribute name="usable" value="false"/>
      <attribute name="burrowed" value="false"/>
      <eventRule event="end">
        <storyState scope="game" variable="King" value="dead"/>
      </eventRule>
      <eventRule event="action_attack" hit="true">
        <playSound sound="sfx/hit.wav"/>
      </eventRule>
      <eventRule event="action_attack" hit="false">
        <playSound sound="sfx/miss.wav"/>
      </eventRule>
      <storyStateRule scope="game" variable="Granner" value="alive" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="Granner" consume="true" from="in-conversation">
          <talk text="Granner being alive is always bad news. We must stop him!"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <storyStateRule scope="game" variable="Granner" value="dead" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="Granner" consume="true" from="in-conversation">
          <talk text="I&#39;m happy he&#39;s been dealt with. We are grateful to you."/>
        </updateConversationGraphTransition>
        <updateConversationGraphTransition actor="other" performative="ask" keyword="blozard" consume="true" from="in-conversation">
          <talk text="Hmm, so Blozard has a hideout... the only way out of here is by sea. Please find him... Take this key! It will grant you access to the piers"/>
          <give inventory="Ocean key"/>
          <updateConversationGraphTransition actor="other" performative="ask" keyword="blozard" consume="true" from="in-conversation">
            <talk text="Please find Blozard, our future is in your hands!"/>
          </updateConversationGraphTransition>
        </updateConversationGraphTransition>
      </storyStateRule>
      <storyStateRule scope="game" variable="Blozard" value="dead" once="true">
        <updateConversationGraphTransition actor="other" performative="ask" keyword="blozard" consume="true" from="in-conversation">
          <talk text="Thank you for you help killing Blozard. You will not be forgotten in Abblegard!"/>
        </updateConversationGraphTransition>
        <updateConversationGraphTransition actor="other" performative="ask" keyword="rumors" consume="true" from="in-conversation">
          <talk text="Well... I heard my daughter set her eyes on you... I need to marry her, you know?"/>
        </updateConversationGraphTransition>
      </storyStateRule>
      <attribute name="hp" value="100" levelupadd="0"/>
      <attribute name="max_hp" value="100"/>
      <attribute name="mp" value="0" levelupadd="0"/>
      <attribute name="max_mp" value="0"/>
      <attribute name="xp" value="0"/>
      <attribute name="level" value="1"/>
      <attribute name="experienceToLevelUp" value="10" levelupmultiply="1.5"/>
      <attribute name="gives_experience" value="100"/>
      <attribute name="attack" value="20" levelupadd="0"/>
      <attribute name="defense" value="10" levelupadd="0"/>
      <attribute name="attack_modifier" value="1"/>
      <attribute name="defense_modifier" value="1"/>
      <attribute name="walk_speed" value="16"/>
      <attribute name="magicImmune" value="false"/>
      <attribute name="direction" value="0"/>
      <attribute name="previous_direction" value="0"/>
      <attribute name="state" value="0"/>
      <attribute name="previous_state" value="0"/>
      <attribute name="state_cycle" value="841"/>
      <items>
        <object class="EquipableItem" completeRedefinition="true">
          <animation name="idle" dx="1" dy="1" period="1" looping="false" file="graphics.png">138</animation>
          <attribute name="ID" value="46"/>
          <attribute name="name" value="King&#39;s Sword"/>
          <attribute name="gold" value="5000"/>
          <attribute name="takeable" value="true"/>
          <attribute name="usable" value="false"/>
          <attribute name="burrowed" value="false"/>
          <attribute name="equipableSlot" value="0"/>
          <attribute name="attack" value="10"/>
          <attribute name="defense" value="5"/>
          <attribute name="magic" value="1"/>
          <attribute name="canChop" value="false"/>
        </object>
        <object class="Key" completeRedefinition="true">
          <animation name="idle" dx="1" dy="1" period="1" looping="false" file="graphics.png">28</animation>
          <attribute name="ID" value="47"/>
          <attribute name="name" value="Ocean key"/>
          <attribute name="takeable" value="true"/>
          <attribute name="usable" value="false"/>
          <attribute name="burrowed" value="false"/>
          <attribute name="keyID" value="DOCKS"/>
        </object>
      </items>
      <attribute name="sightRadius" value="6"/>
      <attribute name="respawn" value="0"/>
      <attribute name="AI.period" value="1"/>
      <attribute name="AI.cycle" value="841"/>
      <onStart>
        <addWME wme="object(31,192,160,224,192,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(31,Soldier)" activation="99"/>
        <addWME wme="object(32,192,96,224,128,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(32,Soldier)" activation="99"/>
        <addWME wme="object(34,320,160,352,192,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(34,Soldier)" activation="99"/>
        <addWME wme="object(35,320,96,352,128,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(35,Soldier)" activation="99"/>
        <addWME wme="object(42,192,32,224,64,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(42,Soldier)" activation="99"/>
        <addWME wme="object(43,320,32,352,64,&#39;the Abblegard Castle&#39;)" activation="99"/>
        <addWME wme="is_a(43,Soldier)" activation="99"/>
        <addWME wme="object(46,?,?,?,?,?)" activation="1"/>
        <addWME wme="is_a(46,EquipableItem)" activation="1"/>
        <addWME wme="object(47,?,?,?,?,?)" activation="1"/>
        <addWME wme="is_a(47,Key)" activation="1"/>
        <addWME wme="bridge(&#39;the forest&#39;,0,448,32,480,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the forest&#39;,736,256,768,288,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the Abblegard Castle&#39;,384,256,448,288,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;a shop&#39;,224,320,256,352,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;an armory&#39;,576,96,608,128,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the inn&#39;,576,384,608,416,&#39;Abblegard&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,160,448,256,480,&#39;the inn&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,608,608,640,640,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,768,512,800,544,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Black Rock entrance&#39;,128,96,160,128,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the east sea&#39;,1248,0,1280,1216,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;the north sea&#39;,1024,0,1472,32,&#39;the forest&#39;)" activation="3000"/>
        <addWME wme="bridge(&#39;Abblegard&#39;,224,480,320,512,&#39;the Abblegard Castle&#39;)" activation="3000"/>
        <addWME wme="friendly(AbblegardCitizen)" activation="3000"/>
        <addWME wme="unfriendly(CultMember)" activation="3000"/>
        <addWME wme="unfriendly(Animal)" activation="3000"/>
        <addWME wme="unfriendly(Undead)" activation="3000"/>
        <addWME wme="location(&#39;home&#39;,256,64,288,96,&#39;the Abblegard Castle&#39;)" activation="3000"/>
        <addBehavior priority="50">
          <BAttackUnfriendly/>
location('home',256,64,288,96,'the Abblegard Castle')</addBehavior>
        <addBehavior priority="0">
          <BGoto location="home" radius="0"/>
location('home',256,64,288,96,'the Abblegard Castle')</addBehavior>
        <pendingTalk character="PlayerCharacter" text="Good lord! It was about time! We were expecting you!"/>
        <pendingTalk character="PlayerCharacter" text="Something misterious has happened..."/>
        <pendingTalk character="PlayerCharacter" text="A few days ago, a peasant reported that the tomb of Granner had been profaned!">
          <addTopic topic="Granner" text="what can you tell me about Granner?"/>
          <addTopic topic="Granner&#39;s tomb" text="Where is Granner&#39;s tomb?"/>
        </pendingTalk>
        <pendingTalk character="PlayerCharacter" text="Additionally, I&#39;ve heard that the forest has been infested with beasts lately."/>
        <pendingTalk character="PlayerCharacter" text="Too many coincidences. We fear the worst... I hope it&#39;s not the Cult of the dragon again..."/>
        <pendingTalk character="PlayerCharacter" text="Please investigate! We shall be waiting news from you."/>
      </onStart>
      <inferenceRule premise="attack(?1,?2),is_a(?2,?3),friendly(?3),is_a(?1,?4)" conclusion="unfriendly(?4)" frequency="0.25" activation="3000" cooldown="50"/>
      <conversationGraph>
        <state name="none">
          <transition actor="self" performative="hi" state="sent-hi" consume="true"/>
          <transition actor="other" performative="hi" state="in-conversation" consume="true">
            <talk text="Good day!" performative="hi"/>
          </transition>
          <transition actor="other" performative="bye" state="none" consume="true">
            <talk text="Farewell!" performative="bye"/>
          </transition>
          <transition actor="other" performative="inform" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start talking to a king!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="ask" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start talking to a king!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="trade" state="in-conversation" consume="false">
            <talk text="That&#39;s no way to start talking to a king!" performative="inform" angry="true" wait="true"/>
          </transition>
        </state>
        <state name="sent-hi">
          <transition actor="other" performative="hi" state="in-conversation" consume="true"/>
          <transition actor="other" performative="bye" state="none" consume="true"/>
          <transition actor="other" performative="inform" state="in-conversation" consume="false">
            <talk text="I would expect a formal greeting before we engage in conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="ask" state="in-conversation" consume="false">
            <talk text="I would expect a formal greeting before we engage in conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="trade" state="in-conversation" consume="false">
            <talk text="I would expect a formal greeting before we engage in conversation!" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="timeout" state="none" consume="true">
            <talk text="Such disrespect..." performative="inform" angry="true" wait="true"/>
          </transition>
        </state>
        <state name="in-conversation">
          <transition actor="self" performative="bye" state="sent-bye" consume="true"/>
          <transition actor="self" performative="inform" consume="true"/>
          <transition actor="other" performative="hi" state="in-conversation" consume="true">
            <talk text="Are you fooling with a king?" performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="bye" state="none" consume="true">
            <talk text="Farewell!" performative="bye"/>
          </transition>
          <transition actor="other" performative="inform" state="in-conversation" consume="true"/>
          <transition actor="other" performative="ask" state="in-conversation" consume="true">
            <talk text="I am sorry, I do not know anything about that." performative="inform"/>
          </transition>
          <transition actor="other" performative="trade" state="in-trade" consume="true">
            <startTrading/>
          </transition>
          <transition actor="other" performative="timeout" state="none" consume="true">
            <talk text="Such disrespect..." performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="ask" keyword="yourself" consume="true">
            <talk text="I&#39;m the proud King of Abblegard."/>
          </transition>
          <transition actor="other" performative="ask" keyword="abblegard" consume="true">
            <talk text="Abblegard is a vibrant village, full of brave people!"/>
          </transition>
          <transition actor="other" performative="ask" keyword="the king" consume="true">
            <talk text="I&#39;m the proud King of Abblegard."/>
          </transition>
          <transition actor="other" performative="ask" keyword="blozard" consume="true">
            <talk text="Blozard was a black dragon that attacked our village many years ago."/>
          </transition>
          <transition actor="other" performative="ask" keyword="Granner" consume="true">
            <talk text="Granner was a priest in the cult of the dragon. I thought he was dead. But now I have doubts."/>
            <addTopic topic="the cult" text="What can you tell me about the cult?"/>
          </transition>
          <transition actor="other" performative="ask" keyword="the cult" consume="true">
            <talk text="The cult is a religious organization that venerates Blozard as their God."/>
            <addTopic topic="blozard" text="What can you tell me about Blozard?"/>
          </transition>
          <transition actor="other" performative="ask" keyword="the black rock" consume="true">
            <talk text="You can find the black rock in the north-west of Abblegard."/>
          </transition>
          <transition actor="other" performative="ask" keyword="Granner&#39;s tomb" consume="true">
            <talk text="It&#39;s in the graveyard south of the village."/>
          </transition>
          <transition actor="other" performative="ask" keyword="Monks" consume="true">
            <talk text="That is terrible! Guards! Follow this man to the Blackrock and cleanse it of evil!"/>
            <addWMEToOthers wme="follow(PlayerCharacter)" activation="3000" characterClass="Soldier" select="all"/>
            <updateConversationGraphTransition actor="other" performative="ask" keyword="Monks" consume="true" from="in-conversation">
              <talk text="I hope they are taken care of now."/>
            </updateConversationGraphTransition>
          </transition>
          <transition actor="other" performative="ask" keyword="Cyril" consume="true">
            <talk text="Cyril was a creaure of legend, a being of evil!"/>
            <talk text="I never thought she actually existed... If she has something to do with this we are in deep trouble..."/>
          </transition>
          <transition actor="other" performative="ask" keyword="stone tablet" consume="true">
            <talk text="There are old Abble-runes. Someone in town might be able to help you translate them."/>
          </transition>
          <transition actor="other" performative="ask" keyword="rumors" consume="true">
            <talk text="I am the King, I don&#39;t pay attention to gossips."/>
          </transition>
        </state>
        <state name="in-trade">
          <transition actor="other" performative="endtrade" state="in-conversation" consume="true"/>
        </state>
        <state name="sent-bye">
          <transition actor="other" state="in-conversation" consume="false">
            <talk text="I though I had dismissed you already..." performative="inform" angry="true" wait="true"/>
          </transition>
          <transition actor="other" performative="bye" state="none" consume="true"/>
        </state>
      </conversationGraph>
    </object>
  </objectgroup>
</map>
